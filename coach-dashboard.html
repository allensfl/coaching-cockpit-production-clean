<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coach-Dashboard - Triadisches KI-Coaching</title>
    <style>
        /* BASE STYLES */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: white;
            min-height: 100vh;
            box-shadow: 0 0 30px rgba(0,0,0,0.1);
        }

        /* HEADER */
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            border-radius: 15px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .session-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            gap: 20px;
        }

        .session-link {
            flex: 1;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            font-size: 0.9em;
        }

        .btn {
            padding: 12px 24px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }

        /* MOBILE & UX FIXES */
        
        /* PROGRESS BAR - Mobile Optimized */
        .progress-container {
            margin: 30px 0;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            position: relative;
            overflow-x: auto;
            overflow-y: hidden;
        }

        .progress-indicator {
            text-align: center;
            font-size: 0.9em;
            color: #666;
            margin-bottom: 15px;
            display: none;
        }

        @media (max-width: 768px) {
            .progress-indicator {
                display: block;
            }
        }

        .progress-bar {
            display: flex;
            align-items: center;
            min-width: 900px;
            height: 80px;
            position: relative;
        }

        @media (max-width: 768px) {
            .progress-container {
                padding: 15px 10px;
                margin: 20px -10px;
            }
            
            .progress-bar {
                min-width: 1000px;
                height: 70px;
            }
        }

        .step {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 80px;
        }

        .step:hover {
            transform: translateY(-5px);
        }

        .step-circle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            margin-bottom: 8px;
            position: relative;
            z-index: 2;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }

        @media (max-width: 768px) {
            .step-circle {
                width: 44px;
                height: 44px;
                font-size: 0.8em;
                margin-bottom: 6px;
            }
        }

        .step-circle.active {
            background: #3498db;
            transform: scale(1.2);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.4);
        }

        .step-circle.completed {
            background: #27ae60;
        }

        .step-title {
            font-size: 0.75em;
            text-align: center;
            font-weight: 500;
            color: #555;
            line-height: 1.2;
            max-width: 70px;
        }

        @media (max-width: 768px) {
            .step-title {
                font-size: 0.7em;
                max-width: 60px;
            }
        }

        .step-line {
            position: absolute;
            top: 25px;
            left: 50%;
            right: -50%;
            height: 3px;
            background: #ddd;
            z-index: 1;
        }

        .step:last-child .step-line {
            display: none;
        }

        .step-line.completed {
            background: #27ae60;
        }

        /* MAIN CONTENT - 3 Panel Layout */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 15px;
            }
        }

        .panel {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border: 2px solid #f1f1f1;
            height: 600px;
            display: flex;
            flex-direction: column;
        }

        @media (max-width: 768px) {
            .panel {
                height: 400px;
                padding: 15px;
            }
        }

        .panel h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3em;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }

        /* COACHEE DIALOG */
        .coachee-messages {
            flex: 1;
            overflow-y: auto;
            border: 2px dashed #bdc3c7;
            border-radius: 10px;
            padding: 15px;
            background: #f8f9fa;
            margin-bottom: 15px;
        }

        .message {
            background: #e3f2fd;
            padding: 12px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #2196f3;
        }

        .message.coach {
            background: #f3e5f5;
            border-left-color: #9c27b0;
        }

        .input-area {
            display: flex;
            gap: 10px;
        }

        .input-area input {
            flex: 1;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
        }

        .input-area button {
            padding: 12px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            min-height: 44px;
        }

        /* TOOL INTEGRATION */
        .tool-integration {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #ddd;
        }

        .tool-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .btn-tool {
            background: #9b59b6;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85em;
            font-weight: 500;
            transition: all 0.3s ease;
            min-height: 36px;
            flex: 1;
            min-width: 120px;
        }

        .btn-tool:hover {
            background: #8e44ad;
            transform: translateY(-1px);
        }

        /* COACH INSTRUCTIONS */
        .coach-instructions {
            background: #e8f4fd;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #2196f3;
        }

        .coach-instructions h5 {
            color: #1976d2;
            margin-bottom: 10px;
            font-size: 1em;
        }

        .instruction-text {
            background: white;
            padding: 15px;
            border-radius: 8px;
            font-family: inherit;
            line-height: 1.5;
            color: #2c3e50;
            border: 1px solid #ddd;
            font-size: 0.9em;
            font-style: italic;
        }

        /* KI PROMPTS */
        .ki-content {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 15px;
        }

        .current-step {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
        }

        .current-step h4 {
            font-size: 1.4em;
            margin-bottom: 10px;
        }

        .step-description {
            font-size: 1em;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .prompt-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid #e74c3c;
        }

        .prompt-section h5 {
            color: #e74c3c;
            margin-bottom: 12px;
            font-size: 1.1em;
        }

        .prompt-text {
            background: white;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            line-height: 1.6;
            color: #2c3e50;
            border: 1px solid #ddd;
            margin-bottom: 15px;
            font-size: 0.95em;
        }

        .ki-suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 15px;
        }

        .suggestion {
            background: #e8f5e8;
            padding: 12px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid #c8e6c9;
            min-height: 44px;
            display: flex;
            align-items: center;
        }

        .suggestion:hover {
            background: #c8e6c9;
            transform: translateY(-2px);
        }

        .ki-input-area {
            background: #f1f1f1;
            padding: 15px;
            border-radius: 10px;
        }

        .ki-input-area textarea {
            width: 100%;
            min-height: 80px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            font-family: inherit;
            resize: vertical;
            line-height: 1.5;
            margin-bottom: 10px;
        }

        .ki-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .btn-send {
            background: #27ae60;
            color: white;
            flex: 1;
            max-width: 150px;
        }

        .btn-send:hover {
            background: #229954;
        }

        .btn-clear {
            background: #95a5a6;
            color: white;
            padding: 12px 20px;
        }

        .btn-clear:hover {
            background: #7f8c8d;
        }

        /* COACH NOTIZEN */
        .notes-area {
            flex: 1;
            margin-bottom: 15px;
        }

        .notes-area textarea {
            width: 100%;
            height: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            font-family: inherit;
            resize: none;
            line-height: 1.5;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .action-buttons button {
            flex: 1;
            min-width: 120px;
            padding: 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            min-height: 44px;
        }

        .btn-copy {
            background: #e74c3c;
            color: white;
        }

        .btn-copy:hover {
            background: #c0392b;
        }

        .btn-repository {
            background: #9b59b6;
            color: white;
        }

        .btn-repository:hover {
            background: #8e44ad;
        }

        .btn-next {
            background: #27ae60;
            color: white;
        }

        .btn-next:hover {
            background: #229954;
        }

        /* MODAL */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 80%;
            overflow-y: auto;
            position: relative;
        }

        .close {
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #aaa;
        }

        .close:hover {
            color: #000;
        }

        /* RESPONSIVE LANDSCAPE */
        @media screen and (orientation: landscape) and (max-height: 500px) {
            .container {
                padding: 10px;
            }
            
            .header {
                padding: 15px;
                margin-bottom: 20px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .panel {
                height: 300px;
            }
            
            .progress-container {
                margin: 15px 0;
            }
        }

        /* UTILITY */
        .text-center {
            text-align: center;
        }

        .mt-2 {
            margin-top: 10px;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎯 Coach-Dashboard</h1>
            <p>Triadisches KI-Coaching - 12 Schritte zum Erfolg</p>
            
            <div class="session-info">
                <div class="session-link">
                    <strong>Coachee-Link:</strong><br>
                    <span id="coachee-link">https://coaching-session.vercel.app/session/ABC123</span>
                </div>
                <button class="btn" onclick="copyCoacheeLink()">📋 Link kopieren</button>
                <button class="btn" onclick="openCoacheeInterface()">👥 Coachee-Interface öffnen</button>
                <button class="btn" onclick="openRepository()">📚 Repository (83 Prompts)</button>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-indicator">← Swipe zum Navigieren →</div>
            <div class="progress-bar" id="progress-bar">
                <!-- Steps werden dynamisch generiert -->
            </div>
        </div>

        <!-- Main Content - 3 Panel Layout -->
        <div class="main-content">
            <!-- Panel 1: Coachee Dialog -->
            <div class="panel">
                <h3>💬 Coachee Dialog</h3>
                <div class="coachee-messages" id="coachee-messages">
                    <div class="message">Hallo! Ich bin bereit für das Coaching. Wo fangen wir an?</div>
                </div>
                <div class="input-area">
                    <input type="text" id="coachee-input" placeholder="Antwort des Coachees eingeben...">
                    <button onclick="addCoacheeMessage()">Senden</button>
                </div>
            </div>

            <!-- Panel 2: KI-Assistent -->
            <div class="panel">
                <h3>🤖 KI-Assistent</h3>
                <div class="ki-content">
                    <div class="current-step" id="current-step">
                        <h4 id="step-title">Schritt wird geladen...</h4>
                        <div class="step-description" id="step-description">
                            Beschreibung wird geladen...
                        </div>
                    </div>

                    <!-- Coach-Anweisungen -->
                    <div class="coach-instructions">
                        <h5>👨‍💼 Coach-Anweisungen:</h5>
                        <div class="instruction-text" id="coach-instructions">
                            Anweisungen werden geladen...
                        </div>
                        
                        <!-- Tool-Integration Buttons -->
                        <div class="tool-integration" id="tool-integration" style="display: none;">
                            <div class="tool-buttons">
                                <button class="btn-tool" onclick="openImageSelector()">
                                    🖼️ Bildauswahl öffnen
                                </button>
                                <button class="btn-tool" onclick="openAvatarTool()">
                                    🎭 Avatar-Tool öffnen
                                </button>
                                <button class="btn-tool" onclick="openPromptRepository()">
                                    📚 Prompt-Repository
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- KI-Prompt -->
                    <div class="prompt-section">
                        <h5>🤖 KI-Prompt für ChatGPT:</h5>
                        <div class="prompt-text" id="current-prompt">
                            Prompt wird geladen...
                        </div>
                        <button class="btn btn-copy" onclick="copyPromptToKI()">
                            📋 Prompt kopieren & in KI einfügen
                        </button>
                    </div>

                    <div class="ki-suggestions">
                        <div class="suggestion" onclick="addSuggestion('Vertiefende Frage stellen')">
                            💡 Vertiefende Frage
                        </div>
                        <div class="suggestion" onclick="addSuggestion('Reflektion anregen')">
                            🤔 Reflektion anregen
                        </div>
                        <div class="suggestion" onclick="addSuggestion('Beispiel geben')">
                            📖 Beispiel geben
                        </div>
                    </div>
                </div>

                <div class="ki-input-area">
                    <textarea id="ki-input" placeholder="KI-Input wird automatisch eingefügt..."></textarea>
                    <div class="ki-actions">
                        <button class="btn btn-send" onclick="sendToKI()">
                            🚀 An KI senden
                        </button>
                        <button class="btn btn-clear" onclick="clearKIInput()">
                            🗑️ Leeren
                        </button>
                    </div>
                </div>
            </div>

            <!-- Panel 3: Coach Notizen -->
            <div class="panel">
                <h3>📝 Coach-Notizen</h3>
                <div class="notes-area">
                    <textarea id="coach-notes" placeholder="Notizen zum aktuellen Schritt...

• Beobachtungen zum Coachee
• Wichtige Erkenntnisse  
• Nächste Schritte
• Besondere Herausforderungen"></textarea>
                </div>
                <div class="action-buttons">
                    <button class="btn-next" onclick="nextStep()">➡️ Nächster Schritt</button>
                    <button class="btn-repository" onclick="openRepository()">📚 Repository</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Repository Modal -->
    <div id="repository-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeRepository()">&times;</span>
            <h2>📚 KI-Coaching Repository</h2>
            <p><strong>82+ spezialisierte Prompts</strong> für verschiedene Coaching-Situationen</p>
            
            <div style="margin-top: 20px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                <h3>🎯 Verfügbare Prompt-Kategorien:</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;">
                    <div>
                        <h4>📐 Struktur & Prozess:</h4>
                        <ul style="margin-left: 20px; line-height: 1.6;">
                            <li><strong>GT1-GT12:</strong> Geißler Triadisch</li>
                            <li><strong>SF1-SF12:</strong> Solution Finder Standard</li>
                            <li><strong>META1-10:</strong> Coach-Unterstützung</li>
                        </ul>
                    </div>
                    <div>
                        <h4>🔍 Analyse & Lösungen:</h4>
                        <ul style="margin-left: 20px; line-height: 1.6;">
                            <li><strong>DIAG1-15:</strong> Diagnostische Prompts</li>
                            <li><strong>LÖS1-15:</strong> Lösungsorientiert</li>
                            <li><strong>WARN1-3:</strong> Notfall & Grenzen</li>
                        </ul>
                    </div>
                </div>
                
                <h4 style="margin-top: 20px;">🚀 Erweiterte Settings:</h4>
                <ul style="margin-left: 20px; line-height: 1.6;">
                    <li><strong>PAAR1-3:</strong> Paare & Teams</li>
                    <li><strong>LIVE1-3:</strong> Live-Coaching Support</li>
                    <li><strong>MOBIL1-3:</strong> Mobile Integration</li>
                </ul>
                
                <div style="margin-top: 20px; padding: 15px; background: #e8f4fd; border-radius: 8px;">
                    <p><strong>💡 System-Features:</strong></p>
                    <ul style="margin-left: 20px;">
                        <li>21 Ruhestand-spezifische Spannungsfelder</li>
                        <li>19 Grundspannungen für alle Übergangsphasen</li>
                        <li>6 Innere Anteile-Typen (Teamchef, Bremse, etc.)</li>
                        <li>Vollständige Wissensbasis integriert</li>
                    </ul>
                </div>
                
                <button class="btn" onclick="openPromptRepository()" style="margin-top: 15px; width: 100%;">
                    🔗 Repository im Vector Store öffnen
                </button>
            </div>
        </div>
    </div>

    <script>
        const steps = [
            {
                id: 1,
                title: "Einleitung und erste Problem-/Zielbeschreibung",
                description: "Das Coaching beginnt mit persönlicher Einleitung und initialer Problemschilderung",
                instructions: "Coach begrüßt Coachingpartner, macht Small Talk und teilt den Bildschirm, um das Konzept des triadischen KI-Coachings vorzustellen. Coach wählt gemeinsam mit Coachee den ersten Prompt ('Coaching Solution Finder') aus. Während der Coachee sein Anliegen schildert, protokolliert der Coach die Kernaussagen schriftlich und fasst alles prägnant zusammen.",
                prompt: "Ich habe folgendes Anliegen: [PROBLEMBESCHREIBUNG]. Kannst du mir helfen, das strukturiert zu durchdenken? Bitte reagiere mit einer freundlichen Begrüßung, spiegle mein Problem in eigenen Worten und identifiziere erste positive Eigenschaften oder Fähigkeiten, die für die Lösung hilfreich sind. Paraphrasiere das Problem, normalisiere es ('nicht ungewöhnlich...') und hebe bereits erste Stärken hervor, um Vertrauen aufzubauen."
            },
            {
                id: 2,
                title: "Erweiterte Problem- und Zielbeschreibung",
                description: "Problem- und Zielbeschreibung wird vertieft und strukturiert",
                instructions: "Coach erfragt zusätzliche Details zur Situation, zum Ist-Zustand und zum gewünschten Soll-Zustand. Coach sammelt die Antworten und formuliert sie knapp. Gemeinsam lesen Coach und Coachee den KI-Bericht durch und prüfen, ob alles korrekt erfasst wurde.",
                prompt: "Hier noch zusätzliche Informationen zu meinem Anliegen: [ERGÄNZUNGEN]. Bitte fasse meine Situation strukturiert zusammen und gliedere in: Ist-Situation (was ist jetzt), Soll-Situation (was soll werden). Erstelle einen in Ich-Form geschriebenen Bericht, in dem alle bisher vorliegenden Informationen zusammengefasst sind. Unterteile in Ist- und Soll-Situation und gehe auf Rahmenbedingungen, innere Prozesse, Verhalten und Konsequenzen ein."
            },
            {
                id: 3,
                title: "Immersive Bildarbeit zur Zielklärung",
                description: "Bildgestützte Methode um Ziel und Emotionen greifbarer zu machen",
                instructions: "Coach bereitet eine Auswahl eindrucksvoller Bilder vor. Coachee wählt spontan das Bild aus, das am besten sein Zielgefühl repräsentiert. Coach fordert auf, das Bild genau zu beschreiben und sich gedanklich hineinzuversetzen. Coach protokolliert die Bildbeschreibung.",
                prompt: "Ich habe folgendes Bild gewählt: [BILDBESCHREIBUNG]. In welcher Beziehung steht die Beschreibung dieses Bildes zu der Beschreibung meines Coaching-Ziels? Analysiere die Parallelen und Metaphern zwischen der Bildsymbolik und meiner Zielsetzung. Verbinde die intuitive Bildwahl mit tieferen Aspekten meines Ziels und erkläre, welche emotionalen und symbolischen Bedeutungen sich daraus ableiten lassen."
            },
            {
                id: 4,
                title: "Überprüfung auf fehlende Informationen (Ausbalancierungsproblem)",
                description: "Prüfung ob wichtige Informationen fehlen und zentrale Muster identifizieren",
                instructions: "Coach verwendet einen Prompt, der auf dem Textbaustein 'Ausbalancierungsprobleme' basiert (18 mögliche Dimensionen). Coach kopiert alle bisherigen Infos zur Problematik in den Prompt. Coach und Coachee gehen die KI-Vorschläge durch und reflektieren gemeinsam.",
                prompt: "Bitte analysiere mein Anliegen und identifiziere mit Hilfe des Textbausteins 'Ausbalancierungsprobleme' dasjenige Ausbalancierungsproblem, das auf Grundlage der vorliegenden Informationen am deutlichsten erkennbar ist. Welche Fragen müsste ich beantworten, um sicherer zu klären, ob es sich tatsächlich um dieses Ausbalancierungsproblem handelt? Erkläre, warum diese Spannungspole für mich relevant sind."
            },
            {
                id: 5,
                title: "Schlüsselsituation und Schlüsselaffekt identifizieren",
                description: "Die typische Situation bestimmen, in der das Problem am stärksten zutage tritt",
                instructions: "Coach und Coachee schauen sich die bisher gesammelten Informationen an und überlegen gemeinsam: 'In welchen konkreten Momenten tritt dein Problem besonders stark auf?' Coach hilft mit vorbereiteten Beispielsätzen für Affektbeschreibungen. Coach notiert die Beschreibung der Schlüsselsituation und des Schlüsselaffekts.",
                prompt: "Hier ist meine Schlüsselsituation: [DETAILLIERTE BESCHREIBUNG]. In diesem Moment fühlte ich: [AFFEKT/EMOTION]. Bitte analysiere diese Situation und hilf mir zu verstehen, was da passiert ist. Erkunde die automatischen Reaktionsmuster und emotionalen Auslöser, um das 'Auge des Taifuns' - den Kern des Problems - klar zu umreißen."
            },
            {
                id: 6,
                title: "Tiefenpsychologisches Interview mit Avataren (Inneres Team)",
                description: "Arbeit mit dem Inneren Team - verschiedene Persönlichkeitsanteile verstehen",
                instructions: "Coach nutzt ein digitales Tool für virtuelle Aufstellungen (CoSpaces.io oder coachingspace.net). Coachee wählt virtuellen Hintergrund. Coach stellt drei Hauptanteile auf: Teamchefin, Unterstützerin, Bremse. Coach führt Interview mit den Figuren, Coachee antwortet in deren Rollen.",
                prompt: "Du führst nun ein tiefenpsychologisches Interview mit meinen inneren Anteilen. Ich habe verschiedene Persönlichkeitsanteile aufgestellt: die Teamchefin (zielorientiert), die Unterstützerin (positiv, mutmachend) und die Bremse (bremsend, aus Angst oder Schutz). Versetze dich bitte in die Perspektive der 'Bremse', die in meinem Transkript spricht. Welche weiteren Argumente könnte diese innere Stimme vorbringen? Was könnte ihre positive Absicht sein?"
            },
            {
                id: 7,
                title: "KI-Analyse der Persönlichkeitsanteile und Ursachen",
                description: "Systematische Auswertung der Avatar-Interviews zur Ursachenfindung",
                instructions: "Coach kopiert das gesamte Transkript des Avatar-Interviews in ChatGPT. Coach stellt drei aufeinanderfolgende Prompts: (a) KI als 'Bremse' agieren lassen, (b) Ranking der 18 Ausbalancierungsdimensionen, (c) Ursachenmodell entwickeln. Coach bespricht Ergebnisse einfühlsam mit Coachee.",
                prompt: "Analysiere das obige Transkript sowie alle momentan vorliegenden Informationen zu meiner Coaching-Problematik mit Hilfe der Kategorien von Ausbalancierungsproblemen. Erstelle mit Blick auf die 18 Ausbalancierungsdimensionen ein Ranking: Welche dieser inneren Konfliktdimensionen sind bei meinem Schlüsselaffekt am relevantesten (Platz 1 = größter Einfluss, Platz 18 = geringster)? Erkläre anschließend, wie diese Haupt-Ursachen zusammenhängen."
            },
            {
                id: 8,
                title: "Übergeordnetes Lern- und Entwicklungsziel formulieren",
                description: "Das 'Thema hinter dem Thema' angehen - übergeordnetes Lernziel definieren",
                instructions: "Coach leitet mit Erinnerung an Erkenntnisse der Problemanalyse ein. Coach erklärt Idee des Lern- und Entwicklungsziels. Coach und Coachee arbeiten gemeinsam daran, das Entwicklungsziel knackig in ein bis zwei Sätzen zu formulieren - positiv und motivierend.",
                prompt: "Formuliere auf Basis der bisherigen Erkenntnisse ein übergeordnetes Lern- und Entwicklungsziel für mich. Was ist das höhere Ziel, das aus dem konkreten Problem erwächst? Welche nachhaltige Veränderung in meiner Haltung oder Fähigkeit soll entwickelt werden? Das Lernziel soll die tieferliegenden Ursachen adressieren und sicherstellen, dass ich für zukünftige ähnliche Herausforderungen gewappnet bin."
            },
            {
                id: 9,
                title: "Antizipieren von Umsetzungswiderständen (innere Widerstände aufstellen)",
                description: "Vorausschauend innere Widerstände identifizieren die gegen Veränderung wirken",
                instructions: "Coach und Coachee überlegen aus den Erkenntnissen der Analyse: 'Welche inneren Extreme wollen vermutlich so bleiben und könnten die Umsetzung sabotieren?' Coach nutzt erneut virtuelle Umgebung und stellt drei alte Tendenzen als Avatare auf. Coach führt wieder Interview mit jedem Widerstands-Anteil.",
                prompt: "Was könnte mich daran hindern, dieses neue Ziel in die Tat umzusetzen? Welche inneren Extreme oder Gewohnheiten wollen vermutlich so bleiben wie sie sind und könnten die Umsetzung sabotieren? Identifiziere die alten Gewohnheiten oder negativen Affekte, die sich gegen die Veränderung sträuben könnten. Welche Bedenken haben diese Anteile? Was sind ihre Schutzfunktionen?"
            },
            {
                id: 10,
                title: "KI-Analyse der Umsetzungswiderstände",
                description: "Analyse der Widerstände um zugrundeliegende Glaubenssätze zu identifizieren",
                instructions: "Coach fügt Transkript des Widerstand-Interviews in ChatGPT ein. Coach bespricht Ergebnisse mit Coachee: 'Erkennst du dich in diesen inneren Überzeugungen wieder?' Oft sehr persönlich - Coach achtet darauf, Coachee zu unterstützen und zu entlasten.",
                prompt: "Analysiere die Äußerungen im obigen Transkript. Rekonstruiere daraus die zugrundeliegenden Regeln, nach denen diese Sprecher die Realität wahrnehmen, Entscheidungen treffen und handeln. Welche Glaubenssätze oder inneren Prinzipien werden deutlich? Welche impliziten Annahmen stecken hinter den Äußerungen der Bremse-Anteile? Diese unbewussten Regeln zu verstehen ist wichtig, um sie gezielt zu verändern."
            },
            {
                id: 11,
                title: "Erfolgsimagination entwickeln (neues Erleben des Erfolgs)",
                description: "Lebhafte mentale Vorwegnahme des zukünftigen Erfolgs erstellen",
                instructions: "Coach formuliert sehr detaillierten Prompt basierend auf Kern-Ungleichgewichten und deren Komplementärkräften. Coach lässt Text laut vorlesen (Coach selbst oder Sprachausgabe), damit Coachee sich voll einlassen kann. Coach empfiehlt, Imagination mehrfach zu üben (Mentaltraining).",
                prompt: "Bitte entwickle eine Erfolgsimagination in Ich-Form für mein Ziel: [ZIEL]. Beschreibe eine persönliche Erlebniserzählung, die mit meiner unveränderten Schlüsselsituation beginnt, dann aber darstellt, wie ich - nachdem ich mich positiv verändert habe - diese Situation ganz anders erlebe und meistere. Beziehe dich auf die komplementären Eigenschaften meiner bisherigen Probleme und auf die Bildmetapher meines Ziels. Formuliere alles sehr anschaulich, als würde es in einem Film geschehen, mit allen Sinnen."
            },
            {
                id: 12,
                title: "Umsetzungsunterstützung (Transfer in den Alltag)",
                description: "Erkenntnisse und Erfolgsimagination in die Realität übertragen",
                instructions: "Coach rekapituliert mit Coachee die Erfolgsimagination als inneren Maßstab. Coach und Coachee gehen KI-Vorschläge durch und wählen realistische und hilfreiche aus. Sie einigen sich auf Sofortmaßnahmen für die nächsten Tage/Wochen. Oft wird Follow-up-Termin vereinbart.",
                prompt: "Erstelle einen konkreten Projektplan mit spezifischen Aktivitäten für die nächsten 4-6 Wochen, damit ich mein übergeordnetes Entwicklungsziel erreiche und die Erfolgsimagination Realität wird. Schlage vor: 1. Tägliches Visualisierungstraining der Erfolgsimagination (Mentaltraining), 2. Konkrete wöchentliche Schritte zur Zielerreichung, 3. Methoden zum Umgang mit Rückschlägen, 4. Belohnungssystem für Teilschritte, 5. Feedback-Mechanismen zur Fortschrittskontrolle."
            }
        ];

        let currentStepIndex = 0;

        // INITIALIZATION
        function initializeApp() {
            console.log('Initializing app with steps:', steps);
            renderProgressBar();
            updateCurrentStep();
            generateCoacheeLink();
        }

        // PROGRESS BAR RENDERING
        function renderProgressBar() {
            const progressBar = document.getElementById('progress-bar');
            progressBar.innerHTML = '';

            steps.forEach((step, index) => {
                const stepElement = document.createElement('div');
                stepElement.className = 'step';
                stepElement.onclick = () => goToStep(index);

                const circle = document.createElement('div');
                circle.className = 'step-circle';
                if (index === currentStepIndex) circle.classList.add('active');
                if (index < currentStepIndex) circle.classList.add('completed');
                circle.textContent = step.id;

                const title = document.createElement('div');
                title.className = 'step-title';
                title.textContent = step.title;

                const line = document.createElement('div');
                line.className = 'step-line';
                if (index < currentStepIndex) line.classList.add('completed');

                stepElement.appendChild(circle);
                stepElement.appendChild(title);
                stepElement.appendChild(line);
                progressBar.appendChild(stepElement);
            });
        }

        // STEP NAVIGATION
        function goToStep(index) {
            currentStepIndex = index;
            updateCurrentStep();
            renderProgressBar();
        }

        function nextStep() {
            if (currentStepIndex < steps.length - 1) {
                currentStepIndex++;
                updateCurrentStep();
                renderProgressBar();
            }
        }

        function updateCurrentStep() {
            const step = steps[currentStepIndex];
            if (!step) return;

            document.getElementById('step-title').textContent = `Schritt ${step.id}: ${step.title}`;
            document.getElementById('step-description').textContent = step.description;
            document.getElementById('coach-instructions').textContent = step.instructions;
            document.getElementById('current-prompt').textContent = step.prompt;

            // Tool-Integration für spezifische Schritte anzeigen
            const toolIntegration = document.getElementById('tool-integration');
            if (step.id === 3 || step.id === 6 || step.id === 9) {
                toolIntegration.style.display = 'block';
            } else {
                toolIntegration.style.display = 'none';
            }

            // Animation
            const currentStepElement = document.getElementById('current-step');
            currentStepElement.classList.remove('fade-in');
            setTimeout(() => currentStepElement.classList.add('fade-in'), 50);
        }

        // KI INPUT MANAGEMENT
        function sendToKI() {
            const kiInput = document.getElementById('ki-input');
            const inputText = kiInput.value.trim();
            
            if (!inputText) {
                alert('Bitte füge erst einen Prompt ein!');
                return;
            }

            // Open ChatGPT in new tab with prompt
            const chatGPTUrl = 'https://chat.openai.com/';
            
            // Copy to clipboard as backup
            navigator.clipboard.writeText(inputText).then(() => {
                // Visual feedback
                const button = document.querySelector('.btn-send');
                const originalText = button.textContent;
                button.textContent = '✅ Kopiert & ChatGPT öffnet...';
                button.style.background = '#27ae60';
                
                // Open ChatGPT
                window.open(chatGPTUrl, '_blank');
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.background = '#27ae60';
                }, 3000);
            });
        }

        function clearKIInput() {
            const kiInput = document.getElementById('ki-input');
            kiInput.value = '';
            kiInput.focus();
        }
        // PROMPT MANAGEMENT
        function copyPromptToKI() {
            const prompt = document.getElementById('current-prompt').textContent;
            const kiInput = document.getElementById('ki-input');
            kiInput.value = prompt;
            
            // Copy to clipboard
            navigator.clipboard.writeText(prompt).then(() => {
                // Visual feedback
                const button = event.target;
                const originalText = button.textContent;
                button.textContent = '✅ Kopiert!';
                button.style.background = '#27ae60';
                
                // Focus KI input
                kiInput.focus();
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.background = '#e74c3c';
                }, 2000);
            });
        }

        // COACHEE DIALOG
        function addCoacheeMessage() {
            const input = document.getElementById('coachee-input');
            const messages = document.getElementById('coachee-messages');
            
            if (input.value.trim()) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message';
                messageDiv.textContent = input.value;
                messages.appendChild(messageDiv);
                
                input.value = '';
                messages.scrollTop = messages.scrollHeight;
            }
        }

        // KI SUGGESTIONS
        function addSuggestion(suggestion) {
            const kiInput = document.getElementById('ki-input');
            const currentValue = kiInput.value;
            kiInput.value = currentValue + (currentValue ? '\n\n' : '') + suggestion;
        }

        // TOOL INTEGRATIONS
        function openImageSelector() {
            // Placeholder für Bildauswahl-Tool
            const images = [
                '🏔️ Person auf Berggipfel',
                '🌅 Sonnenaufgang über Meer',
                '🛤️ Weg durch Wald',
                '🌸 Blühender Garten',
                '🏡 Gemütliches Zuhause',
                '🌟 Sternenhimmel',
                '🌊 Ruhiger See',
                '🔥 Lagerfeuer',
                '🦋 Schmetterling auf Blume',
                '🌈 Regenbogen nach Sturm'
            ];
            
            const selectedImage = prompt('Wählen Sie ein Bild für Schritt 3:\n\n' + 
                images.map((img, i) => `${i+1}. ${img}`).join('\n') + 
                '\n\nBitte Nummer eingeben (1-10):');
            
            if (selectedImage && selectedImage >= 1 && selectedImage <= 10) {
                const imageDescription = images[selectedImage - 1];
                alert(`Gewähltes Bild: ${imageDescription}\n\nDiese Beschreibung wurde für Schritt 3 notiert.`);
                
                // Notiz ins Coach-Notizen Feld einfügen
                const notesArea = document.getElementById('coach-notes');
                notesArea.value += `\n\nGewähltes Bild (Schritt 3): ${imageDescription}`;
            }
        }

        function openAvatarTool() {
            // Placeholder für Avatar-Tool Integration
            const tools = [
                'CoSpaces.io - 3D Avatar-Umgebung',
                'CoachingSpace.net - 2D Aufstellung',
                'Miro/Mural - Digitales Whiteboard',
                'Zoom Whiteboard - Integrierte Lösung'
            ];
            
            const choice = confirm('Avatar-Aufstellung öffnen?\n\n' +
                'Verfügbare Tools:\n' + tools.join('\n') + 
                '\n\nSoll CoSpaces.io geöffnet werden?');
            
            if (choice) {
                window.open('https://cospaces.io', '_blank');
                
                // Notiz ins Coach-Notizen Feld
                const notesArea = document.getElementById('coach-notes');
                notesArea.value += `\n\nAvatar-Tool geöffnet: ${new Date().toLocaleTimeString()}`;
            }
        }

        function openPromptRepository() {
            // Öffnet das Prompt-Repository
            alert('Prompt-Repository öffnet sich...\n\n82+ Prompts verfügbar:\n• GT1-GT12: Geißler Triadisch\n• SF1-SF12: Solution Finder\n• DIAG1-15: Diagnostische Prompts\n• LÖS1-15: Lösungsorientiert\n• META1-10: Coach-Support');
            
            // Placeholder - hier würde das echte Repository geöffnet
            window.open('https://claude.ai', '_blank');
        }

        function openCoacheeInterface() {
            const sessionId = document.getElementById('coachee-link').textContent.split('/').pop();
            const coacheeUrl = `coachee-interface.html?session=${sessionId}`;
            window.open(coacheeUrl, '_blank');
            
            // Visual feedback
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = '✅ Coachee-Interface geöffnet';
            
            setTimeout(() => {
                button.textContent = originalText;
            }, 3000);
        }
        function generateCoacheeLink() {
            const sessionId = Math.random().toString(36).substr(2, 9);
            const link = `https://coaching-session.vercel.app/session/${sessionId}`;
            document.getElementById('coachee-link').textContent = link;
        }

        function copyCoacheeLink() {
            const link = document.getElementById('coachee-link').textContent;
            navigator.clipboard.writeText(link).then(() => {
                const button = event.target;
                const originalText = button.textContent;
                button.textContent = '✅ Kopiert!';
                
                setTimeout(() => {
                    button.textContent = originalText;
                }, 2000);
            });
        }

        // REPOSITORY MODAL
        function openRepository() {
            document.getElementById('repository-modal').style.display = 'block';
        }

        function closeRepository() {
            document.getElementById('repository-modal').style.display = 'none';
        }

        // EVENT LISTENERS
        document.addEventListener('DOMContentLoaded', initializeApp);

        // Close modal on outside click
        window.onclick = function(event) {
            const modal = document.getElementById('repository-modal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }

        // Handle Enter key in coachee input
        document.getElementById('coachee-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addCoacheeMessage();
            }
        });

        console.log('Coach Dashboard loaded successfully');
    </script>
</body>
</html>