<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>12-Schritte KI-Coaching Interface</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .session-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .session-info h1 {
            color: #4a5568;
            font-size: 24px;
        }

        .header-buttons {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #e2e8f0;
            color: #4a5568;
        }

        .btn-secondary:hover {
            background: #cbd5e0;
        }

        .progress-container {
            background: #f7fafc;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .progress-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            position: relative;
        }

        .progress-bar::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 2px;
            background: #e2e8f0;
            z-index: 1;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
            cursor: pointer;
            transition: all 0.3s;
        }

        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e2e8f0;
            color: #a0aec0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-bottom: 8px;
            transition: all 0.3s;
        }

        .step.active .step-circle {
            background: #667eea;
            color: white;
        }

        .step.completed .step-circle {
            background: #48bb78;
            color: white;
        }

        .step-label {
            font-size: 12px;
            text-align: center;
            color: #4a5568;
            max-width: 100px;
        }

        .step-details {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }

        .step-title {
            color: #2d3748;
            font-size: 20px;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .task-list {
            list-style: none;
            margin-bottom: 20px;
        }

        .task-item {
            display: flex;
            align-items: flex-start;
            padding: 10px 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .task-item:last-child {
            border-bottom: none;
        }

        .task-checkbox {
            margin-right: 12px;
            margin-top: 2px;
        }

        .task-text {
            flex: 1;
            line-height: 1.5;
        }

        .task-item.completed .task-text {
            text-decoration: line-through;
            color: #a0aec0;
        }

        .chat-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .chat-panel {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            height: 500px;
        }

        .chat-header {
            padding: 15px 20px;
            border-bottom: 1px solid #e2e8f0;
            font-weight: 600;
            color: #2d3748;
        }

        .coaching-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .assistant-header {
            background: linear-gradient(135deg, #48bb78, #38a169);
            color: white;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f7fafc;
        }

        .message {
            margin-bottom: 15px;
            padding: 12px 16px;
            border-radius: 12px;
            max-width: 85%;
        }

        .message.user {
            background: #667eea;
            color: white;
            margin-left: auto;
        }

        .message.ai {
            background: white;
            color: #2d3748;
            border: 1px solid #e2e8f0;
        }

        .chat-input-container {
            padding: 15px 20px;
            border-top: 1px solid #e2e8f0;
        }

        .chat-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            resize: vertical;
            min-height: 40px;
        }

        .chat-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .send-btn {
            margin-top: 10px;
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
        }

        .send-btn:hover {
            background: #5a6fd8;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }

        .suggestions {
            background: #f0f4f8;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .suggestions h4 {
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .suggestion-item {
            background: white;
            padding: 10px;
            margin: 5px 0;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
        }

        .suggestion-item:hover {
            background: #e2e8f0;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 2% auto;
            padding: 0;
            border-radius: 15px;
            width: 95%;
            max-width: 1200px;
            height: 90vh;
            display: flex;
            flex-direction: column;
        }

        .modal-header {
            padding: 20px 25px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 15px 15px 0 0;
        }

        .modal-body {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
        }

        .close {
            color: white;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            opacity: 0.7;
        }

        .search-container {
            margin-bottom: 20px;
        }

        .search-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .category {
            margin-bottom: 30px;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            overflow: hidden;
        }

        .category-header {
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
            padding: 15px 20px;
            font-weight: 600;
            color: #2d3748;
            border-bottom: 1px solid #e2e8f0;
        }

        .category-description {
            font-size: 14px;
            color: #4a5568;
            margin-top: 5px;
        }

        .prompts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            padding: 20px;
        }

        .prompt-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .prompt-card:hover {
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.1);
            transform: translateY(-2px);
        }

        .prompt-code {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .prompt-text {
            color: #4a5568;
            font-size: 13px;
            line-height: 1.4;
            max-height: 100px;
            overflow: hidden;
            position: relative;
        }

        .copy-feedback {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #48bb78;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 500;
            z-index: 1001;
            transform: translateX(100%);
            transition: transform 0.3s;
        }

        .copy-feedback.show {
            transform: translateX(0);
        }

        .phase-badge {
            display: inline-block;
            background: #e2e8f0;
            color: #4a5568;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
            margin-bottom: 10px;
        }

        .phase-a { background: #fef5e7; color: #744210; }
        .phase-b { background: #e6fffa; color: #234e52; }
        .phase-c { background: #f0fff4; color: #22543d; }

        @media (max-width: 768px) {
            .chat-container {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                width: 98%;
                height: 95vh;
                margin: 1% auto;
            }
            
            .prompts-grid {
                grid-template-columns: 1fr;
            }
            
            .progress-bar {
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .step {
                min-width: 80px;
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- Header -->
        <div class="header">
            <div class="session-info">
                <h1>🎯 Triadisches KI-Coaching</h1>
                <div class="header-buttons">
                    <button class="btn btn-primary" onclick="openRepository()">📚 Triadisches Repository</button>
                    <button class="btn btn-secondary">💾 Auto-Save</button>
                </div>
            </div>
        </div>

        <!-- Progress Container -->
        <div class="progress-container">
            <div class="progress-bar" id="progressBar">
                <!-- Steps will be generated by JavaScript -->
            </div>
        </div>

        <!-- Step Details -->
        <div class="step-details" id="stepDetails">
            <!-- Step content will be generated by JavaScript -->
        </div>

        <!-- Chat Container -->
        <div class="chat-container">
            <!-- Coaching Dialog Panel -->
            <div class="chat-panel">
                <div class="chat-header coaching-header">
                    💬 Coaching-Dialog (Coach ↔ Coachee)
                </div>
                <div class="chat-messages" id="coachingMessages">
                    <div class="message ai">
                        Willkommen zum triadischen KI-Coaching! Ich bin hier, um Sie durch den strukturierten 12-Schritte-Prozess zu begleiten. Beginnen wir mit Schritt 1 - der Problem- und Zielbeschreibung.
                    </div>
                </div>
                <div class="chat-input-container">
                    <textarea class="chat-input" id="coachingInput" placeholder="Ihre Nachricht an den Coach..." rows="2"></textarea>
                    <button class="send-btn" onclick="sendMessage('coaching')">Senden</button>
                </div>
                <div class="suggestions" id="coachingSuggestions">
                    <h4>💡 Empfohlene Fragen für diesen Schritt:</h4>
                    <!-- Suggestions will be generated by JavaScript -->
                </div>
            </div>

            <!-- KI Assistant Panel -->
            <div class="chat-panel">
                <div class="chat-header assistant-header">
                    🤖 KI-Assistent (Coach ↔ KI)
                </div>
                <div class="chat-messages" id="assistantMessages">
                    <div class="message ai">
                        Hallo! Ich bin Ihr KI-Assistent und unterstütze Sie als Coach bei der Durchführung des triadischen Coaching-Prozesses. Nutzen Sie das Repository für passende Prompts oder fragen Sie mich direkt nach Hinweisen für den aktuellen Schritt.
                    </div>
                </div>
                <div class="chat-input-container">
                    <textarea class="chat-input" id="assistantInput" placeholder="Ihre Frage an den KI-Assistenten..." rows="2"></textarea>
                    <button class="send-btn" onclick="sendMessage('assistant')">Senden</button>
                </div>
                <div class="suggestions" id="assistantSuggestions">
                    <h4>🔧 KI-Unterstützung für diesen Schritt:</h4>
                    <!-- Suggestions will be generated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="navigation">
            <button class="btn btn-secondary" onclick="previousStep()" id="prevBtn">← Vorheriger Schritt</button>
            <span id="stepCounter">Schritt 1 von 12</span>
            <button class="btn btn-primary" onclick="nextStep()" id="nextBtn">Nächster Schritt →</button>
        </div>
    </div>

    <!-- Repository Modal -->
    <div id="repositoryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>📚 Triadisches Repository - 73 Prompts in 13 Kategorien</h2>
                <span class="close" onclick="closeRepository()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="search-container">
                    <input type="text" class="search-input" id="searchInput" placeholder="Suchen Sie nach Prompt-Codes (T1, D2, M3...) oder Stichwörtern..." oninput="searchPrompts()">
                </div>
                <div id="repositoryContent">
                    <!-- Repository content will be generated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Copy Feedback -->
    <div id="copyFeedback" class="copy-feedback">Prompt kopiert! ✓</div>

    <script>
        // 12-Schritte Definition mit allen Details
        const steps = [
            {
                id: 1,
                title: "Problem- und Zielbeschreibung",
                phase: "A",
                tasks: [
                    "Coachee beschreibt das Problem in eigenen Worten",
                    "Konkrete Zielsetzung für das Coaching definieren",
                    "Wichtigkeit und Dringlichkeit auf Skala bewerten",
                    "Erste Ressourcen und Stärken identifizieren"
                ],
                coachingSuggestions: [
                    "Beschreiben Sie mir bitte in 1-2 Sätzen, was Sie erreichen möchten.",
                    "Auf einer Skala von 0 bis 10: Wie wichtig ist Ihnen dieses Ziel?",
                    "Was hindert Sie daran, dieses Ziel zu erreichen?"
                ],
                assistantSuggestions: [
                    "Analysiere die Problemstellung auf Ausbalancierungsprobleme",
                    "Identifiziere bereits vorhandene Ressourcen",
                    "Prüfe die Zielformulierung auf Konkretheit und Messbarkeit"
                ]
            },
            {
                id: 2,
                title: "Systemische Einordnung",
                phase: "A",
                tasks: [
                    "Problemkontext und Systemzusammenhänge erfassen",
                    "Beteiligte Personen und deren Rollen identifizieren",
                    "Wechselwirkungen und Abhängigkeiten analysieren",
                    "Systemische Ressourcen erkunden"
                ],
                coachingSuggestions: [
                    "Wer ist noch von dieser Situation betroffen?",
                    "Welche Rollen spielen andere Personen in diesem System?",
                    "Wie würden andere die Situation beschreiben?"
                ],
                assistantSuggestions: [
                    "Erstelle eine systemische Karte der Beteiligten",
                    "Analysiere Wechselwirkungen und Abhängigkeiten",
                    "Identifiziere systemische Ressourcen und Allianzen"
                ]
            },
            {
                id: 3,
                title: "Bildmetapher entwickeln",
                phase: "A",
                tasks: [
                    "Inneres Bild für die aktuelle Situation finden",
                    "Metapher ausführlich beschreiben und vertiefen",
                    "Emotionale Resonanz der Metapher erkunden",
                    "Veränderungspotential in der Metapher entdecken"
                ],
                coachingSuggestions: [
                    "Wenn Ihre Situation ein Bild wäre - wie sähe es aus?",
                    "Welche Farben, Formen und Bewegungen sehen Sie?",
                    "Was fühlen Sie, wenn Sie dieses Bild betrachten?"
                ],
                assistantSuggestions: [
                    "Unterstütze die Entwicklung einer stimmigen Bildmetapher",
                    "Erkunde die symbolische Bedeutung der Bildelemente",
                    "Identifiziere Veränderungsmöglichkeiten in der Metapher"
                ]
            },
            {
                id: 4,
                title: "Ausbalancierungsprobleme identifizieren",
                phase: "A",
                tasks: [
                    "Relevante Spannungsfelder aus den 18 Dimensionen identifizieren",
                    "Polaritäten und deren Ausprägungen analysieren",
                    "Ungleichgewichte und Überbetonungen erkennen",
                    "Komplementäre Kräfte für Balance bestimmen"
                ],
                coachingSuggestions: [
                    "Zwischen welchen Polen bewegen Sie sich in dieser Situation?",
                    "Wo spüren Sie ein Ungleichgewicht?",
                    "Was wäre das Gegenteil Ihres aktuellen Verhaltens?"
                ],
                assistantSuggestions: [
                    "Analysiere mit den 18 Ausbalancierungsdimensionen",
                    "Identifiziere die 2-3 relevantesten Spannungsfelder",
                    "Bestimme komplementäre Kräfte für mehr Balance"
                ]
            },
            {
                id: 5,
                title: "Schlüsselaffekt benennen",
                phase: "B",
                tasks: [
                    "Dominanten emotionalen Zustand identifizieren",
                    "Körperliche Empfindungen des Affekts erfassen",
                    "Auslöser und Muster des Schlüsselaffekts erkunden",
                    "Zusammenhang zu den Ausbalancierungsproblemen herstellen"
                ],
                coachingSuggestions: [
                    "Welches Gefühl ist in dieser Situation am stärksten?",
                    "Wo spüren Sie dieses Gefühl in Ihrem Körper?",
                    "Wann taucht dieses Gefühl typischerweise auf?"
                ],
                assistantSuggestions: [
                    "Identifiziere den Schlüsselaffekt aus der Beschreibung",
                    "Verbinde den Affekt mit den Ausbalancierungsproblemen",
                    "Analysiere Auslöser und wiederkehrende Muster"
                ]
            },
            {
                id: 6,
                title: "Inneres Team aufstellen",
                phase: "B",
                tasks: [
                    "Verschiedene innere Anteile identifizieren",
                    "Jeder Anteil bekommt Namen und Charakteristika",
                    "Positive Absichten aller Anteile würdigen",
                    "Teamchef-Anteil als Koordinator bestimmen"
                ],
                coachingSuggestions: [
                    "Welche verschiedenen Stimmen hören Sie in sich?",
                    "Geben Sie jedem Anteil einen Namen und beschreiben Sie ihn",
                    "Was will jeder Anteil für Sie Gutes erreichen?"
                ],
                assistantSuggestions: [
                    "Identifiziere die wichtigsten inneren Anteile",
                    "Beschreibe deren positive Absichten und Schutzfunktionen",
                    "Bestimme einen geeigneten Teamchef-Anteil"
                ]
            },
            {
                id: 7,
                title: "Dialog zwischen den Anteilen",
                phase: "B",
                tasks: [
                    "Konflikthafte Anteile in Dialog bringen",
                    "Verschiedene Perspektiven verstehen und würdigen",
                    "Gemeinsame Werte und Ziele identifizieren",
                    "Kompromisse und Kooperationen entwickeln"
                ],
                coachingSuggestions: [
                    "Was würde der eine Anteil dem anderen sagen?",
                    "Wo haben beide Anteile recht?",
                    "Wie könnten sie zusammenarbeiten?"
                ],
                assistantSuggestions: [
                    "Moderiere den Dialog zwischen konflikthaften Anteilen",
                    "Suche nach gemeinsamen Werten und Zielen",
                    "Entwickle Kooperationsvorschläge für die Anteile"
                ]
            },
            {
                id: 8,
                title: "Lösungsstrategie entwickeln",
                phase: "C",
                tasks: [
                    "Konkrete Handlungsoptionen erarbeiten",
                    "Strategien für den Umgang mit Spannungsfeldern entwickeln",
                    "Ressourcen und Unterstützungsmöglichkeiten aktivieren",
                    "Realistische Umsetzungsschritte planen"
                ],
                coachingSuggestions: [
                    "Welche Handlungsmöglichkeiten sehen Sie jetzt?",
                    "Was würde Ihnen bei der Umsetzung helfen?",
                    "Welche Unterstützung brauchen Sie?"
                ],
                assistantSuggestions: [
                    "Entwickle konkrete Lösungsstrategien basierend auf der Analyse",
                    "Integriere die Erkenntnisse aus den Ausbalancierungsproblemen",
                    "Plane realistische und machbare Umsetzungsschritte"
                ]
            },
            {
                id: 9,
                title: "Innere Anteile transformieren",
                phase: "C",
                tasks: [
                    "Neue Rollen für die inneren Anteile definieren",
                    "Transformationsprozess für problematische Anteile einleiten",
                    "Stärkung der hilfreichen Anteile",
                    "Neue Teamdynamik etablieren"
                ],
                coachingSuggestions: [
                    "Wie könnte sich dieser Anteil in Zukunft verhalten?",
                    "Welche neue Rolle wäre für ihn passend?",
                    "Wie kann der Teamchef die anderen Anteile besser führen?"
                ],
                assistantSuggestions: [
                    "Unterstütze die Transformation der inneren Anteile",
                    "Entwickle neue, konstruktive Rollen für jeden Anteil",
                    "Stärke die Führungsrolle des Teamchef-Anteils"
                ]
            },
            {
                id: 10,
                title: "Glaubenssätze transformieren",
                phase: "C",
                tasks: [
                    "Limiting beliefs identifizieren und hinterfragen",
                    "Neue, unterstützende Glaubenssätze entwickeln",
                    "Verankerung der neuen Überzeugungen",
                    "Integration in das Selbstbild"
                ],
                coachingSuggestions: [
                    "Welche Überzeugungen hindern Sie noch?",
                    "Was würden Sie stattdessen gerne glauben?",
                    "Wie können Sie diese neue Überzeugung stärken?"
                ],
                assistantSuggestions: [
                    "Identifiziere dysfunktionale Glaubenssätze",
                    "Entwickle alternative, unterstützende Überzeugungen",
                    "Plane Übungen zur Verankerung neuer Glaubenssätze"
                ]
            },
            {
                id: 11,
                title: "Erfolgsimagination kreieren",
                phase: "C",
                tasks: [
                    "Lebendige Zukunftsvision in allen Sinneskanälen entwickeln",
                    "Emotionale Verankerung der Erfolgsvision",
                    "Integration der transformierten Anteile in die Vision",
                    "Motivation und Vorfreude aktivieren"
                ],
                coachingSuggestions: [
                    "Stellen Sie sich vor, Sie haben Ihr Ziel erreicht - was sehen, hören, fühlen Sie?",
                    "Wie verhalten sich Ihre inneren Anteile in dieser Zukunft?",
                    "Was ist das Beste an dieser neuen Situation?"
                ],
                assistantSuggestions: [
                    "Kreiere eine detaillierte, sinnliche Erfolgsimagination",
                    "Integriere alle transformierten Anteile in die Vision",
                    "Verwende die Bildmetapher in der transformierten Form"
                ]
            },
            {
                id: 12,
                title: "Integration und Handlungsplan",
                phase: "C",
                tasks: [
                    "Alle Erkenntnisse und Transformationen zusammenfassen",
                    "Konkreten Handlungsplan mit Terminen erstellen",
                    "Erfolgskontrollen und Reflexionspunkte definieren",
                    "Nachhaltigkeit und Transfer sicherstellen"
                ],
                coachingSuggestions: [
                    "Was nehmen Sie als wichtigste Erkenntnis mit?",
                    "Welche konkreten Schritte gehen Sie als nächstes?",
                    "Wie bleiben Sie mit Ihren neuen Erkenntnissen in Kontakt?"
                ],
                assistantSuggestions: [
                    "Erstelle eine Zusammenfassung aller wichtigen Erkenntnisse",
                    "Entwickle einen detaillierten Handlungsplan",
                    "Plane Follow-up Termine und Erfolgskontrollen"
                ]
            }
        ];

        // Vollständige Prompt Database mit allen 73 Prompts
        const promptDatabase = {
            'ki_phase1': {
                title: '🤖 KI-Prompts Phase 1',
                description: 'Anweisungen AN die KI',
                prompts: {
                    'T1': 'Ich habe folgendes Problem und möchte es mit Ihnen bearbeiten...',
                    'T2': 'Erstelle einen in Ich-Form geschriebenen Bericht, in dem alle bisher vorliegenden Informationen der Problem- und Zielbeschreibung zusammengefasst sind. Gliedere diesen Bericht in zwei Teile: 1) Problembeschreibung und 2) Zielbeschreibung.',
                    'T3': 'Analysiere die vorliegenden Informationen und identifiziere die Kernproblematik. Welche Muster und Zusammenhänge sind erkennbar?',
                    'T4': 'Identifiziere aus dem Textbaustein Ausbalancierungsprobleme die relevanten Spannungsfelder für diese Problematik.'
                }
            },
            'ki_phase2': {
                title: '🤖 KI-Prompts Phase 2',
                description: 'Anweisungen AN die KI',
                prompts: {
                    'T7A': 'Versetze dich bitte in die Bremse - den inneren Anteil, der vor Veränderung warnt. Was würde dieser Anteil sagen?',
                    'T7B': 'Analysiere das obige Transkript sowie alle momentan vorliegenden Informationen zu meiner Coachingproblematik mit Hilfe des Textbausteins Ausbalancierungsprobleme und erstelle mit Blick auf die 18 Ausbalancierungsdimensionen eine detaillierte Diagnose.',
                    'T7C': 'Führe eine systemische Analyse durch und identifiziere alle relevanten Faktoren und Akteure.'
                }
            },
            'ki_phase3': {
                title: '🤖 KI-Prompts Phase 3',
                description: 'Anweisungen AN die KI',
                prompts: {
                    'T8': 'Entwickle konkrete Lösungsstrategien basierend auf der vorangegangenen Analyse.',
                    'T10': 'Erstelle einen detaillierten Handlungsplan mit konkreten Schritten und Terminen.',
                    'T11': 'Orientiere dich bei dieser Aufgabe an dem Textbaustein Ausbalancierungsprobleme, da ist Coaching-diagnostisches Wissen hinterlegt. Gehe dabei im Einzelnen folgendermaßen vor: Beziehe dich auf die Komplementärkräfte und entwickle eine Erfolgsimagination.'
                }
            },
            'coach_instructions': {
                title: '👨‍💼 Coach-Anweisungen',
                description: 'WIE der Coach vorgeht',
                prompts: {
                    'C1': 'Stellen Sie sich vor, da ist ein Teamchef in Ihnen - das ist der Teil, der dieses Ziel erreichen will. Wählen Sie eine Figur für diesen Teamchef und beschreiben Sie ihn.',
                    'C2': 'Führen Sie den Klienten durch eine systematische Exploration der verschiedenen inneren Anteile.',
                    'C3': 'Ich möchte gerne mit der Bremse sprechen - dem Anteil, der Sie vor Veränderung schützen will.',
                    'C4': 'Leiten Sie eine Ressourcen-Aktivierung ein und identifizieren Sie vorhandene Stärken.',
                    'C5': 'Unterstützen Sie den Transformationsprozess der inneren Anteile.',
                    'C6': 'Begleiten Sie die Integration der Erkenntnisse in den Alltag.'
                }
            },
            'client_questions': {
                title: '❓ Klienten-Fragen',
                description: 'Fragen AN den Klienten',
                prompts: {
                    'F1': 'Beschreiben Sie mir bitte in 1-2 Sätzen, was Sie erreichen möchten.',
                    'F2': 'Auf einer Skala von 0 bis 10: Wie wichtig ist Ihnen dieses Ziel?',
                    'F3': 'Was hindert Sie daran, dieses Ziel zu erreichen?',
                    'F4': 'Welche Ressourcen haben Sie bereits zur Verfügung?',
                    'F5': 'Wie würden Sie merken, dass Sie Ihr Ziel erreicht haben?',
                    'F6': 'Was wäre der erste kleine Schritt in die richtige Richtung?',
                    'F7': 'Wer oder was könnte Sie dabei unterstützen?',
                    'F8': 'Welche Erfolge haben Sie in ähnlichen Situationen bereits erlebt?'
                }
            },
            'spannungsfelder': {
                title: '⚖️ Spannungsfeld-Fragen',
                description: '40 Ruhestand-Spannungen',
                prompts: {
                    'SP1': 'Zwischen welchen Polen bewegen Sie sich gerade?',
                    'SP20': 'Wie balancieren Sie Aktivität und Ruhe?',
                    'SP21': 'Was bedeutet Erfolg für Sie in dieser Lebensphase?',
                    'SP23': 'Wenn Sie an Ihre Arbeitszeit denken - was vermissen Sie, was nicht?',
                    'SP24': 'Schwanken Sie zwischen dem Wunsch nach Struktur und dem nach Freiheit?',
                    'SP25': 'Wie gehen Sie mit dem Gefühl von Nutzlosigkeit um?',
                    'SP26': 'Zwischen Alleinsein und Gesellschaft - wo fühlen Sie sich wohl?',
                    'SP27': 'Schwanken Sie zwischen Gesellschaft und Ruhe?',
                    'SP28': 'Wie erleben Sie den Wandel Ihrer sozialen Rolle?',
                    'SP36': 'Wie gehen Sie mit körperlichen Veränderungen um?',
                    'SP37': 'Zwischen Vitalität und Akzeptanz - wo stehen Sie?',
                    'SP38': 'Wie denken Sie über Ihre Endlichkeit?',
                    'SP33': 'Was gibt Ihrem Leben Sinn und Bedeutung?',
                    'SP39': 'Zwischen Bewahrung des Erreichten und Neubeginn?',
                    'SP40': 'Wie möchten Sie in dieser Lebensphase noch weiterwachsen?'
                }
            },
            'diagnostik': {
                title: '🧠 Diagnostik',
                description: 'Diagnose & Spannungsfelder erfassen',
                prompts: {
                    'D1': 'Analysiere die folgende Aussage mit Blick auf mögliche Ausbalancierungsprobleme: ‹Ich kann einfach nicht loslassen – ich muss alles selbst im Griff haben.› – Welche Spannungsdimensionen sind hier aktiv? – Welche komplementäre Kraft könnte hilfreich sein? – Was wäre ein ressourcenfokussierter Coachingansatz?',
                    'D2': 'Lies folgende Klient:innenaussage: ‹Ich weiss, ich sollte etwas tun, aber innerlich bin ich wie gelähmt.› – Welcher Schlüsselaffekt zeigt sich hier? – Was könnte die innere Dynamik dahinter sein? – Welche erste kleine Intervention wäre denkbar?',
                    'D3': 'Eine Klientin sagt: ‹Ein Teil von mir will einfach Ruhe, aber der andere macht mir Druck, weiterzumachen.› – Welche zwei inneren Anteile könnten hier aktiv sein? – Was wollen sie jeweils schützen oder erreichen? – Wie könnte der Coach innere Verständigung anregen?',
                    'D4': 'Ein Coachee sagt: ‹Ich muss immer stark sein – Schwäche zeigen geht nicht.› – Welcher dysfunktionale Glaubenssatz ist hier aktiv? – Welcher positive Wert steckt vielleicht dahinter? – Wie könnte man diesen Satz achtsam in Frage stellen?'
                }
            },
            'intervention': {
                title: '🛠️ Intervention',
                description: 'Lösungsorientierte Mikrointerventionen',
                prompts: {
                    'I1': 'Ein Coachee sagt: ‹Ich weiss nicht, wie ich anfangen soll – es ist alles zu viel.› – Welche kleine lösungsfokussierte Frage könnte den nächsten Schritt erleichtern? – Welche vorhandene Ressource kann aktiviert werden? – Was wäre eine hilfreiche Skalierungsfrage dazu?',
                    'I2': 'Bitte formuliere eine motivierende Erfolgsimagination in Ich-Form für folgende Zielrichtung: ‹Ich möchte in meinem Ruhestand klarer spüren, was mir gut tut – und mutiger danach handeln.› – Baue sinnliche Eindrücke ein (sehen, hören, fühlen) – Zeige den Unterschied zur Ausgangssituation – Integriere den inneren Dialog der Veränderung',
                    'I3': 'Stelle einem Coachee mit aktuellem Mutverlust folgende Frage: ‹Wann in deinem Leben hast du schon einmal eine ähnliche Situation bewältigt – und wie hast du das damals geschafft?› – Welche Elemente aus der damaligen Lösung lassen sich heute nutzen? – Was hat dich damals gestützt?',
                    'I4': 'Ein Coachee sagt: ‹Ich werde im Ruhestand ganz sicher überflüssig sein.› – Formuliere eine Frage, die den gegenteiligen Gedanken prüft, z. B.: ‹Was wäre, wenn du gerade dann besonders gebraucht wirst – vielleicht anders als bisher?› – Welche neue Perspektive könnte daraus entstehen?',
                    'I5': 'Stelle dir vor, du begegnest deinem 10 Jahre älteren Ich – es wirkt ruhig, klar und zugewandt. – Was würde es dir raten für deine aktuelle Situation? – Welche Werte oder Haltungen strahlt es aus? – Was sagt es dir über den Weg, den du gehen willst?'
                }
            },
            'metaphern': {
                title: '🌀 Metaphern & Sprache',
                description: 'Bilder die berühren und wirken',
                prompts: {
                    'M1': 'Bitte rege einen Coachee an, seine aktuelle Lebenslage als inneres Bild zu beschreiben: – ‹Wenn deine Situation ein Bild wäre – wie sähe es aus? Was wäre zu sehen, zu spüren, zu hören?› – ‹Welche Farben, Formen, Bewegungen kommen vor?› – ‹Was zeigt sich dir darin über dein inneres Erleben?›',
                    'M2': 'Ein Coachee beschreibt ein wiederkehrendes, belastendes Gefühl. Bitte leite folgende Imaginationsfrage an: – ‹Stell dir vor, dieses Gefühl wäre eine Figur – wie sieht sie aus, wie spricht sie, wie bewegt sie sich?› – ‹Wie heisst sie – und was will sie dir sagen?› – ‹Welche gute Absicht könnte dahinterstecken?›',
                    'M3': 'Leite folgende Übung an: ‹Stell dir dein Leben als Garten vor. Welche Pflanzen wachsen darin? Wo ist es üppig, wo karg? – Gibt es Bereiche, die mehr Pflege brauchen? – Was wächst vielleicht schon, ohne dass du es merkst? – Was möchtest du neu anlegen?›',
                    'M4': 'Bitte frage: ‹Wenn du das so sagst – wo im Körper spürst du das am meisten?› – ‹Wie verändert sich die Körperempfindung, wenn du die Formulierung leicht abwandelst?› – ‹Welche Worte fühlen sich stimmiger an?› Beispiel: Aus ‹Ich muss loslassen› wird ‹Ich darf sanft weitergehen›',
                    'M5': 'Ein Coachee sagt: ‹Ich weiss einfach nicht mehr, was ich will.› – Bitte formuliere daraus eine sprachlich berührende Metapher, z. B.: ‹Wie ein Segel ohne Wind treibe ich auf offenem Meer – sehnend nach einem Kompass.› – Frage zurück: ‹Was wäre dein nächster Kurs – auch ohne Wind?›'
                }
            },
            'skalierung': {
                title: '📏 Skalierung & Reflexion',
                description: 'Klarheit schaffen, Entwicklung sichtbar machen',
                prompts: {
                    'S1': 'Bitte leite eine klassische Skalierungsfrage an: – ‹Auf einer Skala von 0 bis 10 – wobei 10 bedeutet: Es ist genau so, wie du es dir wünschst – wo stehst du heute?› – ‹Was ist schon da, dass du bei dieser Zahl stehst und nicht bei einer tieferen?› – ‹Was müsste passieren, damit du einen Punkt höher kämst?›',
                    'S2': 'Coachee hat bereits Schritte unternommen. Bitte frage: – ‹Wenn du zurückblickst: Wo standest du vor zwei Wochen – auf derselben Skala?› – ‹Was hat sich seitdem bewegt – innerlich wie äusserlich?› – ‹Was kannst du dir selbst dafür anerkennen?›',
                    'S3': 'Bitte gib einem Coachee eine Anleitung, wie er eine Skala über mehrere Tage führen kann: – ‹Wähle ein Thema, z. B. dein Energielevel, deine Gelassenheit oder Zuversicht.› – ‹Trage jeden Abend eine Zahl zwischen 0 und 10 ein.› – ‹Beobachte Muster, Auslöser und Veränderungen – ohne Bewertung.› – ‹Was fällt dir nach einer Woche auf?›',
                    'S4': 'Bitte leite eine einfache Aufstellung im Raum an: – ‹Stell dir drei Punkte im Raum vor: deinen aktuellen Standpunkt, dein Wunschbild, und einen Beobachterpunkt.› – ‹Gehe die Positionen ab – was nimmst du jeweils wahr?› – ‹Welche neue Sicht entsteht aus dem Beobachterpunkt?›',
                    'S5': 'Bitte leite eine dreiteilige Reflexion an: – ‹1. Was ist konkret passiert?› – ‹2. Wie habe ich mich dabei gefühlt, was hat mich geleitet?› – ‹3. Was nehme ich daraus mit – was bleibt, was lerne ich?›'
                }
            },
            'modelle': {
                title: '🧭 Modell-Zuordnung',
                description: 'Coachingmodelle gezielt anwenden',
                prompts: {
                    'MO1': 'Bitte leite ein Coachinggespräch mit dem GROW-Modell an: – G: ‹Was ist dein Ziel in dieser Sitzung?› – R: ‹Wo stehst du aktuell in Bezug auf dieses Ziel?› – O: ‹Welche Möglichkeiten hast du, dich dem Ziel zu nähern?› – W: ‹Was wirst du konkret als Nächstes tun – und wann?›',
                    'MO2': 'Bitte frage den Coachee: – ‹Bist du gerade eher in einer Phase des Abschiednehmens, der Zwischenzeit oder eines Neuanfangs?› – ‹Was zeigt sich für dich in dieser Phase?› – ‹Was hilft dir, gut durch diese Zeit zu gehen – und was wäre der nächste kleine Schritt?›',
                    'MO3': 'Bitte leite eine Tetralemma-Frageführung ein: – ‹Was spricht für A?› – ‹Was spricht für B?› – ‹Was wäre eine dritte Option, ein Sowohl-als-auch?› – ‹Was wäre ein ganz anderer, überraschender vierter Weg?› – ‹Und wenn du das Ganze einmal komplett in Frage stellst – was zeigt sich als fünfte Möglichkeit?›',
                    'MO4': 'Bitte leite ein Gespräch mit dem Lebensrad an: – ‹Stell dir einen Kreis mit acht Segmenten vor: Beruf, Beziehungen, Gesundheit, Freizeit, Persönliches Wachstum, Finanzen, Wohnumfeld, Sinn/Spiritualität.› – ‹Wie zufrieden bist du mit jedem Bereich – auf einer Skala von 0 bis 10?› – ‹Was möchtest du stärken oder verändern?› – ‹Welcher erste Schritt ergibt sich daraus?›',
                    'MO5': 'Bitte leite eine ZRM-orientierte Übung an: – ‹Gibt es ein Bild, das dich spontan anspricht – ohne genau zu wissen, warum?› – ‹Was löst es körperlich, emotional oder gedanklich in dir aus?› – ‹Was könnte ein Mottoziel sein, das diese Resonanz einfängt?› – ‹Wie würdest du dieses Motto in dein Leben integrieren?›'
                }
            },
            'prompt_gestaltung': {
                title: '🧩 Prompt-Gestaltung',
                description: 'Meta-Prompts für wirksame KI-Dialoge',
                prompts: {
                    'PG1': 'Formuliere deinen Prompt entlang dieser vier Elemente: – Person: Wer spricht oder antwortet (z. B. «Du bist ein empathischer Coach …») – Perspektive: Welche Rolle oder Haltung wird eingenommen (z. B. systemisch, lösungsfokussiert, narrativ …) – Prozess: Was soll die KI konkret tun (analysieren, paraphrasieren, visualisieren …) – Purpose: Wozu dient das Ganze? (Klarheit, Struktur, Aktivierung etc.)',
                    'PG2': 'Kennzeichne jede Zeile durch ein Tag: – <COACH>: Anweisung oder Einleitung des Coachs – <KI>: Antwort oder Analyse durch die KI – <COACHEE>: Reaktion oder Input des Coachee (optional simuliert)',
                    'PG3': 'Nutze die 3-A-Regel: – Anerkennen: «Danke, dass du das teilst …» – Aufgreifen: «Du beschreibst also … Das klingt nach …» – Anregen: «Was wäre, wenn du diesen Aspekt mal aus einer anderen Perspektive betrachtest …?»',
                    'PG4': 'Baue modulare Prompts: «Du bist [Rolle] mit [Haltung]. Deine Aufgabe ist es, [Prozess] auszuführen, um [Ziel].» → Ergänzbar mit: Kontextwissen, Skalen, Methodenbezug, Visualisierung, Sprachstil etc.',
                    'PG5': 'Antworte so, wie ein einfühlsamer Coach mit klarer Sprache, lösungsorientierter Haltung und einem Hauch Leichtigkeit schreiben würde. Vermeide leere Floskeln, bleibe menschlich.'
                }
            },
            'textbausteine': {
                title: '🧠 KI-Textbausteine',
                description: 'Coaching-DNA für die KI',
                prompts: {
                    'TB1': 'COACHING SOLUTION FINDER: Du bist ein erfahrener, empathischer Coach. Deine Aufgabe ist es, ressourcenorientiert und wertschätzend zu antworten. Beginne immer mit einer dankenden Begrüßung für das Vertrauen. Paraphrasiere das Problem in eigenen Worten, normalisiere es ("Das ist nicht ungewöhnlich...") und hebe bereits erkennbare Stärken, Ressourcen oder positive Ansätze hervor. Dein Ton ist warmherzig, ermutigend und professionell. Fokussiere auf Potenziale statt Defizite.',
                    'TB2': 'AUSBALANCIERUNGSPROBLEME (18 Dimensionen): 1. Minderwertigkeit vs. Großartigkeit, 2. Anerkennungsstreben vs. Egozentrik, 3. Selbstinszenierung vs. Zurückhaltung, 4. Kontrolle vs. Vertrauen, 5. Nähe vs. Distanz, 6. Rationalität vs. Intuition, 7. Perfektion vs. Spontaneität, 8. Sicherheit vs. Risiko, 9. Autonomie vs. Zugehörigkeit, 10. Struktur vs. Flexibilität, 11. Leistung vs. Entspannung, 12. Selbstfürsorge vs. Aufopferung, 13. Offenheit vs. Bewahrung, 14. Durchsetzung vs. Harmonie, 15. Individualität vs. Anpassung, 16. Aktivität vs. Passivität, 17. Optimismus vs. Realismus, 18. Bindung vs. Freiheit. Jede Dimension beschreibt ein mögliches inneres Spannungsfeld.',
                    'TB3': 'SCHLÜSSELAFFEKTE: "Ich fühle mich wie gelähmt und meine Gedanken kreisen..." / "Ich bin wie blockiert und alles andere erscheint plötzlich wichtiger..." / "Ich spüre Enttäuschung/Überforderung und kann keinen klaren Gedanken fassen..." / "Ich fühle mich innerlich unruhig und getrieben..." / "Es steigt Panik in mir auf und ich will nur noch weg..." / "Ich spüre eine bleierne Schwere und Mutlosigkeit..." / "Mein Kopf wird leer und ich kann mich nicht konzentrieren..." / "Ich fühle mich klein und hilflos wie ein Kind..." / "Es wird eng in mir und ich bekomme kaum noch Luft..." / "Ich spüre Wut und Frustration, die mich lähmt..."',
                    'TB4': 'ERFOLGSIMAGINATION: Erstelle eine lebhafte, sinnliche Erzählung in Ich-Form mit folgenden Elementen: – Beginne mit der ursprünglichen Schlüsselsituation – Beschreibe die neue, positive Reaktion detailliert – Integriere die komplementären Kräfte der Ausbalancierungsprobleme – Verwende die Bildmetapher aus Schritt 3 – Mache es filmisch erlebbar (was sehe, höre, fühle ich?) – Beschreibe innere Dialoge und neue Gedankenmuster – Zeige konkrete Handlungen und deren positive Konsequenzen – Verwende warme, motivierende Sprache – Schaffe einen emotionalen Anker für das neue Verhalten',
                    'TB5': 'INNERE ANTEILE: Teamchefin/Zielerreicher (rational, zielorientiert, plant), Unterstützerin/Mutmacher (optimistisch, ermutigend, sieht Chancen), Bremse/Beschützer (vorsichtig, sicherheitsorientiert, warnt), Kritiker/Perfektionist (hohe Standards, fehlerfinderisch), Anerkennungssucher (braucht Bestätigung, möchte gemocht werden), Rebell/Innovator (hinterfragt Regeln, will Neues), Harmoniestifter (vermeidet Konflikte, sucht Ausgleich), Kontrolleur (will alles unter Kontrolle, plant detailliert). Jeder Anteil hat positive Absichten und schützenswerte Bedürfnisse.',
                    'TB6': 'GLAUBENSSÄTZE-ANALYSE: Perfektion ("Ich darf keine Fehler machen"), Anerkennung ("Mein Wert hängt von der Meinung anderer ab"), Kontrolle ("Ich muss alles kontrollieren können"), Sicherheit ("Sichtbarkeit ist riskant"), Leistung ("Ich bin nur wertvoll, wenn ich leiste"), Selbstwert ("Ich bin nicht gut genug"). Analysiere die zugrundeliegenden Regeln der Realitätswahrnehmung und deren Schutzfunktion.'
                }
            }
        };

        // State Management
        let currentStep = 1;
        let stepData = {};

        // Initialize Application
        function initializeApp() {
            loadStepData();
            renderProgressBar();
            renderStepDetails();
            updateNavigation();
            renderRepositoryContent();
        }

        // Progress Bar Rendering
        function renderProgressBar() {
            const progressBar = document.getElementById('progressBar');
            progressBar.innerHTML = '';

            steps.forEach((step, index) => {
                const stepElement = document.createElement('div');
                stepElement.className = 'step';
                if (step.id === currentStep) stepElement.classList.add('active');
                if (stepData[step.id]?.completed) stepElement.classList.add('completed');

                stepElement.innerHTML = `
                    <div class="step-circle">${step.id}</div>
                    <div class="step-label">${step.title}</div>
                `;

                stepElement.onclick = () => goToStep(step.id);
                progressBar.appendChild(stepElement);
            });
        }

        // Step Details Rendering
        function renderStepDetails() {
            const step = steps.find(s => s.id === currentStep);
            const stepDetails = document.getElementById('stepDetails');
            
            const phaseClass = `phase-${step.phase.toLowerCase()}`;
            
            stepDetails.innerHTML = `
                <div class="phase-badge ${phaseClass}">Phase ${step.phase}</div>
                <div class="step-title">${step.id}. ${step.title}</div>
                <ul class="task-list">
                    ${step.tasks.map((task, index) => `
                        <li class="task-item ${stepData[currentStep]?.tasks?.[index] ? 'completed' : ''}">
                            <input type="checkbox" class="task-checkbox" 
                                   ${stepData[currentStep]?.tasks?.[index] ? 'checked' : ''}
                                   onchange="toggleTask(${index})">
                            <span class="task-text">${task}</span>
                        </li>
                    `).join('')}
                </ul>
            `;

            updateSuggestions();
        }

        // Update Suggestions
        function updateSuggestions() {
            const step = steps.find(s => s.id === currentStep);
            
            // Coaching Suggestions
            const coachingSuggestions = document.getElementById('coachingSuggestions');
            coachingSuggestions.innerHTML = `
                <h4>💡 Empfohlene Fragen für diesen Schritt:</h4>
                ${step.coachingSuggestions.map(suggestion => `
                    <div class="suggestion-item" onclick="insertText('coaching', \`${suggestion}\`)">
                        ${suggestion}
                    </div>
                `).join('')}
            `;

            // Assistant Suggestions
            const assistantSuggestions = document.getElementById('assistantSuggestions');
            assistantSuggestions.innerHTML = `
                <h4>🔧 KI-Unterstützung für diesen Schritt:</h4>
                ${step.assistantSuggestions.map(suggestion => `
                    <div class="suggestion-item" onclick="insertText('assistant', \`${suggestion}\`)">
                        ${suggestion}
                    </div>
                `).join('')}
            `;
        }

        // Task Management
        function toggleTask(taskIndex) {
            if (!stepData[currentStep]) stepData[currentStep] = { tasks: [] };
            if (!stepData[currentStep].tasks) stepData[currentStep].tasks = [];
            
            stepData[currentStep].completed = allCompleted;
            
            saveStepData();
            renderProgressBar();
            renderStepDetails();
        }

        // Navigation
        function goToStep(stepId) {
            currentStep = stepId;
            renderProgressBar();
            renderStepDetails();
            updateNavigation();
        }

        function previousStep() {
            if (currentStep > 1) {
                currentStep--;
                renderProgressBar();
                renderStepDetails();
                updateNavigation();
            }
        }

        function nextStep() {
            if (currentStep < steps.length) {
                currentStep++;
                renderProgressBar();
                renderStepDetails();
                updateNavigation();
            }
        }

        function updateNavigation() {
            document.getElementById('prevBtn').disabled = currentStep === 1;
            document.getElementById('nextBtn').disabled = currentStep === steps.length;
            document.getElementById('stepCounter').textContent = `Schritt ${currentStep} von ${steps.length}`;
        }

        // Chat Functions
        function sendMessage(chatType) {
            const inputId = chatType === 'coaching' ? 'coachingInput' : 'assistantInput';
            const messagesId = chatType === 'coaching' ? 'coachingMessages' : 'assistantMessages';
            
            const input = document.getElementById(inputId);
            const messages = document.getElementById(messagesId);
            
            if (input.value.trim()) {
                // Add user message
                const userMessage = document.createElement('div');
                userMessage.className = 'message user';
                userMessage.textContent = input.value;
                messages.appendChild(userMessage);
                
                // Simulate AI response (in real implementation, this would call OpenAI API)
                simulateAIResponse(messagesId, chatType, input.value);
                
                input.value = '';
                messages.scrollTop = messages.scrollHeight;
            }
        }

        function simulateAIResponse(messagesId, chatType, userMessage) {
            const messages = document.getElementById(messagesId);
            
            setTimeout(() => {
                const aiMessage = document.createElement('div');
                aiMessage.className = 'message ai';
                
                if (chatType === 'coaching') {
                    aiMessage.textContent = `Vielen Dank für Ihr Vertrauen. Ich verstehe, dass Sie "${userMessage.substring(0, 50)}..." beschäftigt. Das ist eine wichtige Beobachtung. Lassen Sie uns das gemeinsam weiter erkunden...`;
                } else {
                    aiMessage.textContent = `Basierend auf Ihrer Anfrage "${userMessage.substring(0, 50)}..." empfehle ich Ihnen, die Ausbalancierungsdimensionen zu analysieren. Nutzen Sie Prompt T${currentStep} aus dem Repository für eine strukturierte Herangehensweise.`;
                }
                
                messages.appendChild(aiMessage);
                messages.scrollTop = messages.scrollHeight;
            }, 1000);
        }

        function insertText(chatType, text) {
            const inputId = chatType === 'coaching' ? 'coachingInput' : 'assistantInput';
            const input = document.getElementById(inputId);
            input.value = text;
            input.focus();
        }

        // Repository Functions
        function openRepository() {
            document.getElementById('repositoryModal').style.display = 'block';
        }

        function closeRepository() {
            document.getElementById('repositoryModal').style.display = 'none';
        }

        function renderRepositoryContent() {
            const content = document.getElementById('repositoryContent');
            content.innerHTML = '';

            Object.keys(promptDatabase).forEach(categoryKey => {
                const category = promptDatabase[categoryKey];
                const categoryElement = document.createElement('div');
                categoryElement.className = 'category';
                categoryElement.innerHTML = `
                    <div class="category-header">
                        ${category.title}
                        <div class="category-description">${category.description}</div>
                    </div>
                    <div class="prompts-grid">
                        ${Object.keys(category.prompts).map(promptKey => `
                            <div class="prompt-card" onclick="copyPrompt('${promptKey}', \`${category.prompts[promptKey].replace(/`/g, '\\`').replace(/\$/g, '\\Step].tasks[taskIndex] = !stepData[currentStep].tasks[taskIndex];
            
            // Check if all tasks are completed
            const step = steps.find(s => s.id === currentStep);
            const allCompleted = step.tasks.every((_, index) => stepData[currentStep].tasks[index]);
            stepData[current)}\`)">
                                <div class="prompt-code">${promptKey}</div>
                                <div class="prompt-text">${category.prompts[promptKey].substring(0, 150)}${category.prompts[promptKey].length > 150 ? '...' : ''}</div>
                            </div>
                        `).join('')}
                    </div>
                `;
                content.appendChild(categoryElement);
            });
        }

        function searchPrompts() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const categories = document.querySelectorAll('.category');
            
            categories.forEach(category => {
                const prompts = category.querySelectorAll('.prompt-card');
                let hasVisiblePrompts = false;
                
                prompts.forEach(prompt => {
                    const code = prompt.querySelector('.prompt-code').textContent.toLowerCase();
                    const text = prompt.querySelector('.prompt-text').textContent.toLowerCase();
                    
                    if (code.includes(searchTerm) || text.includes(searchTerm)) {
                        prompt.style.display = 'block';
                        hasVisiblePrompts = true;
                    } else {
                        prompt.style.display = 'none';
                    }
                });
                
                category.style.display = hasVisiblePrompts ? 'block' : 'none';
            });
        }

        function copyPrompt(code, text) {
            navigator.clipboard.writeText(text).then(() => {
                showCopyFeedback();
                
                // Also insert into active chat input
                const coachingInput = document.getElementById('coachingInput');
                const assistantInput = document.getElementById('assistantInput');
                
                // Determine which input to use based on prompt type
                if (code.startsWith('T') || code.startsWith('TB') || code.startsWith('D') || code.startsWith('PG')) {
                    assistantInput.value = text;
                } else {
                    coachingInput.value = text;
                }
            });
        }

        function showCopyFeedback() {
            const feedback = document.getElementById('copyFeedback');
            feedback.classList.add('show');
            setTimeout(() => {
                feedback.classList.remove('show');
            }, 2000);
        }

        // Data Persistence
        function saveStepData() {
            try {
                localStorage.setItem('coaching-step-data', JSON.stringify(stepData));
            } catch (e) {
                console.log('LocalStorage nicht verfügbar');
            }
        }

        function loadStepData() {
            try {
                const saved = localStorage.getItem('coaching-step-data');
                stepData = saved ? JSON.parse(saved) : {};
            } catch (e) {
                stepData = {};
            }
        }

        // Event Listeners
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeRepository();
            }
            
            if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
                const activeElement = document.activeElement;
                if (activeElement.id === 'coachingInput') {
                    sendMessage('coaching');
                } else if (activeElement.id === 'assistantInput') {
                    sendMessage('assistant');
                }
            }
        });

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('repositoryModal');
            if (event.target === modal) {
                closeRepository();
            }
        }

        // Initialize app when page loads
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>Step].tasks[taskIndex] = !stepData[currentStep].tasks[taskIndex];
            
            // Check if all tasks are completed
            const step = steps.find(s => s.id === currentStep);
            const allCompleted = step.tasks.every((_, index) => stepData[currentStep].tasks[index]);
            stepData[current