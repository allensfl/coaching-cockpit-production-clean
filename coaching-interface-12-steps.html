<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Triadisches KI-Coaching Interface</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      overflow-x: hidden;
    }

    .container {
      max-width: 1600px;
      margin: 0 auto;
      padding: 20px;
      min-height: 100vh;
    }

    .header {
      background: white;
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      text-align: center;
      position: relative;
    }

    .header h1 {
      color: #333;
      font-size: 2.5em;
      margin-bottom: 10px;
      font-weight: 700;
    }

    .session-info {
      color: #666;
      font-size: 1.1em;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 15px;
      flex-wrap: wrap;
    }

    .progress-container {
      background: white;
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .progress-header h2 {
      color: #333;
      font-size: 1.5em;
    }

    .phase-indicator {
      display: flex;
      gap: 10px;
    }

    .phase-label {
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 0.9em;
      font-weight: 600;
    }

    .phase-a { background: #e3f2fd; color: #1976d2; }
    .phase-b { background: #f3e5f5; color: #7b1fa2; }
    .phase-c { background: #e8f5e8; color: #388e3c; }

    .progress-bar {
      display: grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 8px;
      margin-bottom: 20px;
    }

    .progress-step {
      background: #f0f0f0;
      border: 2px solid #ddd;
      border-radius: 10px;
      padding: 15px 8px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }

    .progress-step.completed {
      background: #d4edda;
      border-color: #28a745;
      color: #155724;
    }

    .progress-step.active {
      background: #cce5ff;
      border-color: #007bff;
      color: #004085;
      box-shadow: 0 0 0 3px rgba(0,123,255,0.25);
    }

    .progress-step.pending {
      background: #f8f9fa;
      border-color: #dee2e6;
      color: #6c757d;
    }

    .step-number {
      font-weight: bold;
      font-size: 1.1em;
      margin-bottom: 5px;
    }

    .step-title {
      font-size: 0.8em;
      line-height: 1.2;
    }

    .main-content {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      height: calc(100vh - 280px);
    }

    .left-panel {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      overflow-y: auto;
    }

    .right-panel {
      display: grid;
      grid-template-rows: 1fr 1fr;
      gap: 20px;
    }

    .chat-panel, .assistant-panel {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      overflow-y: auto;
    }

    .step-content h3 {
      color: #333;
      margin-bottom: 20px;
      font-size: 1.4em;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }

    .task-list {
      list-style: none;
      padding: 0;
    }

    .task-item {
      background: #f8f9fa;
      border: 1px solid #e9ecef;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 12px;
      display: flex;
      align-items: flex-start;
      gap: 12px;
      transition: all 0.3s ease;
    }

    .task-item:hover {
      background: #e9ecef;
    }

    .task-item.completed {
      background: #d4edda;
      border-color: #c3e6cb;
      opacity: 0.8;
    }

    .task-checkbox {
      width: 20px;
      height: 20px;
      border: 2px solid #007bff;
      border-radius: 4px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      margin-top: 2px;
    }

    .task-checkbox.checked {
      background: #007bff;
      color: white;
    }

    .task-text {
      flex: 1;
      line-height: 1.5;
    }

    .task-text.completed {
      text-decoration: line-through;
      opacity: 0.7;
    }

    .progress-indicator {
      background: #e9ecef;
      border-radius: 10px;
      padding: 15px;
      margin: 20px 0;
      text-align: center;
    }

    .progress-bar-fill {
      background: linear-gradient(90deg, #007bff, #28a745);
      height: 8px;
      border-radius: 4px;
      transition: width 0.3s ease;
      margin-bottom: 10px;
    }

    .navigation-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 30px;
    }

    .nav-button {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 1em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .nav-button.prev {
      background: #6c757d;
      color: white;
    }

    .nav-button.next {
      background: #007bff;
      color: white;
    }

    .nav-button.next.completed {
      background: #28a745;
    }

    .nav-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    .nav-button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .chat-messages {
      max-height: 300px;
      overflow-y: auto;
      margin-bottom: 20px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
      border: 1px solid #e9ecef;
    }

    .message {
      margin-bottom: 15px;
      padding: 10px;
      border-radius: 8px;
      max-width: 80%;
    }

    .message.coach {
      background: #e3f2fd;
      border-left: 4px solid #2196f3;
    }

    .message.coachee {
      background: #f3e5f5;
      border-left: 4px solid #9c27b0;
      margin-left: auto;
    }

    .message.ai {
      background: #e8f5e8;
      border-left: 4px solid #4caf50;
    }

    .message-sender {
      font-weight: bold;
      margin-bottom: 5px;
      font-size: 0.9em;
    }

    .chat-input {
      display: flex;
      gap: 10px;
    }

    .chat-input input {
      flex: 1;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 1em;
      outline: none;
    }

    .chat-input button {
      padding: 12px 20px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
    }

    .assistant-suggestions {
      margin-bottom: 20px;
    }

    .suggestion {
      background: #f8f9fa;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .suggestion:hover {
      background: #e9ecef;
      border-color: #007bff;
    }

    .suggestion.clicked {
      background: #d4edda;
      border-color: #28a745;
    }

    .modal {
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background: white;
      border-radius: 15px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.3);
      position: relative;
      max-height: 90vh;
      overflow-y: auto;
      width: 90%;
      max-width: 1200px;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      border-bottom: 2px solid #eee;
    }

    .modal-header h2 {
      margin: 0;
      color: #333;
    }

    .close {
      font-size: 30px;
      font-weight: bold;
      cursor: pointer;
      color: #999;
      transition: color 0.3s;
    }

    .close:hover {
      color: #666;
    }

    .modal-body {
      padding: 20px;
    }

    .usage-tip {
      background: #e3f2fd;
      border: 1px solid #bbdefb;
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 20px;
      color: #1976d2;
      font-size: 0.9em;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .repo-categories {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 20px;
    }

    .repo-category {
      background: #f8f9fa;
      border-radius: 10px;
      padding: 20px;
    }

    .repo-category h3 {
      margin-bottom: 15px;
      color: #333;
      font-size: 1.2em;
    }

    .repo-prompt-card {
      background: white;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .repo-prompt-card:hover {
      border-color: #667eea;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .repo-prompt-card.copied {
      background: #d4edda;
      border-color: #28a745;
      animation: pulse 0.5s ease-in-out;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.02); }
      100% { transform: scale(1); }
    }

    .repo-prompt-code {
      background: #667eea;
      color: white;
      padding: 3px 8px;
      border-radius: 12px;
      font-size: 0.8em;
      font-weight: bold;
      margin-right: 8px;
    }

    .repo-prompt-name {
      font-weight: 600;
      color: #333;
      margin-bottom: 5px;
    }

    .repo-prompt-text {
      color: #666;
      font-size: 0.9em;
      line-height: 1.4;
    }

    .search-bar {
      margin-bottom: 20px;
    }

    .search-bar input {
      width: 100%;
      padding: 12px;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
      outline: none;
    }

    .search-bar input:focus {
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    @media (max-width: 768px) {
      .main-content {
        grid-template-columns: 1fr;
        grid-template-rows: 1fr auto;
      }
      
      .right-panel {
        grid-template-rows: 1fr;
        grid-template-columns: 1fr;
      }
      
      .progress-bar {
        grid-template-columns: repeat(6, 1fr);
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Triadisches KI-Coaching Interface</h1>
      <div class="session-info">
        <span>Session: #12345</span>
        <span>‚Ä¢</span>
        <span id="currentDateTime">17.07.2025, 14:30</span>
        <span>‚Ä¢</span>
        <span>Auto-Save: <span id="saveStatus">Gespeichert</span></span>
        <span>‚Ä¢</span>
        <button id="repositoryBtn" onclick="openRepository()" style="background: #667eea; color: white; border: none; padding: 8px 16px; border-radius: 20px; cursor: pointer; font-size: 1em; font-weight: 600;">
          üìö Triadisches Repository
        </button>
      </div>
    </div>

    <div class="progress-container">
      <div class="progress-header">
        <h2>Coaching-Fortschritt</h2>
        <div class="phase-indicator">
          <div class="phase-label phase-a">Phase 1: Problem & Ziel</div>
          <div class="phase-label phase-b">Phase 2: Problemanalyse</div>
          <div class="phase-label phase-c">Phase 3: L√∂sungsstrategie</div>
        </div>
      </div>
      
      <div class="progress-bar" id="progressBar">
        <!-- Schritte werden hier dynamisch eingef√ºgt -->
      </div>
    </div>

    <div class="main-content">
      <div class="left-panel">
        <div class="step-content" id="stepContent">
          <!-- Schritt-Inhalte werden hier dynamisch eingef√ºgt -->
        </div>
      </div>

      <div class="right-panel">
        <div class="chat-panel">
          <h3>üí¨ Coaching-Dialog</h3>
          <div class="chat-messages" id="chatMessages">
            <div class="message coach">
              <div class="message-sender">Coach</div>
              <div>Willkommen zum triadischen KI-Coaching! Lassen Sie uns gemeinsam mit Ihrem Anliegen beginnen.</div>
            </div>
          </div>
          <div class="chat-input">
            <input type="text" id="coachingInput" placeholder="Nachricht eingeben..." onkeypress="if(event.key==='Enter') sendCoachingMessage()">
            <button onclick="sendCoachingMessage()">Senden</button>
          </div>
        </div>

        <div class="assistant-panel">
          <h3>ü§ñ KI-Assistent</h3>
          <div class="assistant-suggestions" id="assistantSuggestions">
            <p><strong>Triadische Prompts f√ºr aktuellen Schritt</strong></p>
            <div id="currentStepSuggestions">
              <!-- Suggestions werden hier dynamisch eingef√ºgt -->
            </div>
          </div>
          <div class="chat-input">
            <input type="text" id="assistantInput" placeholder="Frage an KI-Assistent..." onkeypress="if(event.key==='Enter') sendAssistantMessage()">
            <button onclick="sendAssistantMessage()">Fragen</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Repository Modal -->
    <div id="repositoryModal" class="modal" style="display: none;">
      <div class="modal-content">
        <div class="modal-header">
          <h2>üìö Triadisches Coaching Repository</h2>
          <span class="close" onclick="closeRepository()">&times;</span>
        </div>
        <div class="modal-body">
          <div class="usage-tip">
            üí° <strong>Klicke auf einen Prompt-Code um ihn zu kopieren und direkt im Chat zu verwenden!</strong>
          </div>
          
          <div class="search-bar">
            <input type="text" id="repoSearchInput" placeholder="Suche nach Code oder Stichwort... (z.B. T1, T7A, Bremse)">
          </div>

          <div class="repo-categories">
            <!-- KI-Prompts Phase 1 -->
            <div class="repo-category">
              <h3>ü§ñ KI-Prompts Phase 1</h3>
              <p style="font-size: 0.9em; color: #666; margin-bottom: 15px;">Anweisungen AN die KI</p>
              <div class="repo-prompts" id="kiPhase1-repo-prompts">
                <!-- Wird dynamisch gef√ºllt -->
              </div>
            </div>

            <!-- KI-Prompts Phase 2 -->
            <div class="repo-category">
              <h3>ü§ñ KI-Prompts Phase 2</h3>
              <p style="font-size: 0.9em; color: #666; margin-bottom: 15px;">Anweisungen AN die KI</p>
              <div class="repo-prompts" id="kiPhase2-repo-prompts">
                <!-- Wird dynamisch gef√ºllt -->
              </div>
            </div>

            <!-- KI-Prompts Phase 3 -->
            <div class="repo-category">
              <h3>ü§ñ KI-Prompts Phase 3</h3>
              <p style="font-size: 0.9em; color: #666; margin-bottom: 15px;">Anweisungen AN die KI</p>
              <div class="repo-prompts" id="kiPhase3-repo-prompts">
                <!-- Wird dynamisch gef√ºllt -->
              </div>
            </div>

            <!-- Coach-Anweisungen -->
            <div class="repo-category">
              <h3>üë®‚Äçüíº Coach-Anweisungen</h3>
              <p style="font-size: 0.9em; color: #666; margin-bottom: 15px;">WIE der Coach vorgeht</p>
              <div class="repo-prompts" id="coachAnweisungen-repo-prompts">
                <!-- Wird dynamisch gef√ºllt -->
              </div>
            </div>

            <!-- Klienten-Fragen -->
            <div class="repo-category">
              <h3>‚ùì Klienten-Fragen</h3>
              <p style="font-size: 0.9em; color: #666; margin-bottom: 15px;">Fragen AN den Klienten</p>
              <div class="repo-prompts" id="klientenFragen-repo-prompts">
                <!-- Wird dynamisch gef√ºllt -->
              </div>
            </div>

            <!-- Spannungsfeld-Fragen -->
            <div class="repo-category">
              <h3>‚öñÔ∏è Spannungsfeld-Fragen</h3>
              <p style="font-size: 0.9em; color: #666; margin-bottom: 15px;">40 Ruhestand-Spannungen</p>
              <div class="repo-prompts" id="spannungsfeldFragen-repo-prompts">
                <!-- Wird dynamisch gef√ºllt -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Triadische Prompts Datenbank - 6 Kategorien
    const repositoryPrompts = {
      // 1. KI-Prompts Phase 1 (Anweisungen AN die KI)
      kiPhase1: [
        {
          code: 'T1',
          name: 'Problem-Start f√ºr KI',
          prompt: 'Ich habe folgendes Problem: [PROBLEM BESCHREIBEN]'
        },
        {
          code: 'T2',
          name: 'KI-Anweisung: Ist-Soll-Bericht',
          prompt: 'Erstelle einen in Ich-Form geschriebenen Bericht, in dem alle bisher vorliegenden Informationen der Problem- und Zielbeschreibung zusammengefasst sind. Gliedere diesen Bericht in zwei Teile, indem Du zun√§chst die vorliegende Ist-Situation und dann die von mir gew√ºnschte Soll-Situation beschreibst. Nimm ‚Äì soweit m√∂glich ‚Äì in jedem der beiden Teile auf folgende Aspekte Bezug, n√§mlich auf die vorliegenden √§u√üeren Rahmenbedingungen und √§u√üerlichen Ressourcen einschlie√ülich meiner k√∂rperlichen Bedingungen, auf meine psychischen Prozesse (wie z.B. Gef√ºhle, motivationale Impulse und Gedanken), die durch die vorliegende Coachingproblematik bei mir aktuell ausgel√∂st werden, auf meine beobachtbaren Verhaltensweisen, die durch die vorliegende Coachingproblematik bei mir aktuell ausgel√∂st werden, und auf die faktischen Folgen, die meine beobachtbaren Verhaltensweisen bei meinen Mitmenschen und bei mir selbst verursachen.'
        },
        {
          code: 'T3',
          name: 'KI-Anweisung: Bildanalyse',
          prompt: 'Ich habe folgendes Bild gew√§hlt: [Bildbeschreibung in Ich-Form]. Was sagt dieses Bild √ºber mein Coaching-Ziel aus? In welcher Beziehung stehen Bild und Zielbeschreibung zueinander?'
        },
        {
          code: 'T4',
          name: 'KI-Anweisung: Ausbalancierungsproblem identifizieren',
          prompt: 'Identifiziere aus dem Textbaustein Ausbalancierungsprobleme dasjenige Ausbalancierungsproblem, dass du auf der Grundlage der vorliegenden Informationen zu meinem Coaching Problem und Ziel am klarsten erkennen kannst. Welche Fragen m√ºsste ich beantworten, damit noch sicherer zu kl√§ren ist, ob es sich tats√§chlich um das von dir identifizierte Ausbalancierungsproblem handelt?'
        }
      ],

      // 2. KI-Prompts Phase 2 (Anweisungen AN die KI)
      kiPhase2: [
        {
          code: 'T7A',
          name: 'KI-Anweisung: Als Bremse agieren',
          prompt: 'Versetze dich bitte in die Bremse, die in dem obigen Transkript erw√§hnt wird und trage noch weitere Argumente vor, die dagegen sprechen, mein Coachingziel zu verfolgen. Lass dich bei dieser Aufgabe von dem Textbaustein Ausbalancierungsprobleme sowie durch die anderen hochgeladenen Textbausteine inspirieren.'
        },
        {
          code: 'T7B',
          name: 'KI-Anweisung: Dimensionen-Ranking',
          prompt: 'Analysiere das obige Transkript sowie alle momentan vorliegenden Informationen zu meiner Coachingproblematik mit Hilfe des Textbausteins Ausbalancierungsprobleme und erstelle mit Blick auf die 18 Ausbalancierungsdimensionen, die in diesem Textbaustein beschrieben sind, ein Ranking der Ausbalancierungsdimensionen. Das hei√üt, setze diejenige Ausbalancierungsdimension auf Rangplatz 1, die f√ºr meinen Schl√ºsselaffekt und mein gesamtes Coachingproblem am wichtigsten ist, und diejenige, die am wenigsten wichtig ist, auf Rangplatz 18.'
        },
        {
          code: 'T7C',
          name: 'KI-Anweisung: Kausalzusammenh√§nge',
          prompt: 'Gehe bitte von dieser Rangpositionierung aus und kl√§re, wie die Probleme, die den Ausbalancierungsdimensionen zugrunde liegen, urs√§chlich zusammenh√§ngen. Also das gesamte Kausalgef√ºge zwischen diesen drei Dimensionen und die entsprechenden Problematiken sollte verdeutlicht werden.'
        }
      ],

      // 3. KI-Prompts Phase 3 (Anweisungen AN die KI)
      kiPhase3: [
        {
          code: 'T8',
          name: 'KI-Anweisung: Entwicklungsziel formulieren',
          prompt: 'Formuliere auf Basis der bisherigen Erkenntnisse ein √ºbergeordnetes Lern- und Entwicklungsziel f√ºr mich.'
        },
        {
          code: 'T10',
          name: 'KI-Anweisung: Widerstandsanalyse',
          prompt: 'Analysiere dieses Transkript. Welche realit√§tspr√§genden √úberzeugungen und inneren Regeln stecken hinter den Aussagen der Widerst√§nde? Was hemmt die Umsetzung meines Entwicklungsziels?'
        },
        {
          code: 'T11',
          name: 'KI-Anweisung: Erfolgsimagination',
          prompt: 'Orientiere dich bei dieser Aufgabe an dem Textbaustein Ausbalancierungsprobleme, da ist Coaching-diagnostisches Wissen hinterlegt. Gehe dabei im Einzelnen folgenderma√üen vor: Beziehe dich auf die Komplement√§rkr√§fte, die dort auch genau beschrieben sind, und das jeweilige Ideal einer optimalen Ausbalancierung, die in diesem Textbaustein mit Bezug auf die Ausbalancierungsprobleme beschrieben ist. Beschreibe die positiven Ver√§nderungen in einer in Ich-Form verfassten pers√∂nlichen Erlebenserz√§hlung, die ich jetzt sofort als Erfolgsimagination nutzen will. Beschreibe in dieser Erfolgsimagination alles sehr differenziert, lebensnah und pers√∂nlich und zwar so, dass man es sich wie in einem Film alles ganz konkret vorstellen kann - also alles was √§u√üerlich beobachtbar passiert und alles was intrapsychisch in mir passiert. Die Erlebenserz√§hlung startet mit der Schl√ºsselsituation, die sich nicht ver√§ndert hat. Lege also die Beschreibung der Schl√ºsselsituation zugrunde, die ich dir zu Beginn dieses Chats mitgeteilt habe. Anschlie√üend beschreibst du in dem pers√∂nlichen Erlebensbericht in Ich-Form den deutlich ver√§nderten Schl√ºsselaffekt. Beziehe dich dabei auf die am Anfang unseres Chats dir mitgeteilte Beschreibung des Bildes, das f√ºr mich eine Visualisierung meines Ziels darstellt, und erstelle in diesem Sinne zwei deutlich unterschiedliche Erlebensbeschreibungen.'
        }
      ],

      // 4. Coach-Anweisungen (WIE der Coach vorgeht)
      coachAnweisungen: [
        {
          code: 'C1',
          name: 'Teamchef einf√ºhren',
          prompt: 'Stellen Sie sich vor, da ist ein Teamchef in Ihnen - das ist der Teil, der dieses Ziel erreichen will. W√§hlen Sie eine Figur oder einen Gegenstand, der diesen Teil repr√§sentiert und stellen Sie ihn hier auf. Was sagt dieser Teamchef? Lassen Sie ihn sprechen: "Ich will, dass wir..."'
        },
        {
          code: 'C2',
          name: 'Bremse aufdecken',
          prompt: 'Und da ist bestimmt auch ein Teil in Ihnen, der Bedenken hat oder bremst. Sp√ºren Sie ihn? Was sagt diese innere Stimme? W√§hlen Sie auch daf√ºr eine Figur.'
        },
        {
          code: 'C3',
          name: 'Interview mit Bremse',
          prompt: 'Ich m√∂chte gerne mit der Bremse sprechen. K√∂nnen Sie in diese Rolle hineinsp√ºren? ... Hallo Bremse, ich habe Ihre Bedenken geh√∂rt. Was genau macht Ihnen Sorgen an dem Vorhaben des Teamchefs?'
        },
        {
          code: 'C4',
          name: 'Interview mit Unterst√ºtzer',
          prompt: 'Jetzt wende ich mich an den Unterst√ºtzer. K√∂nnen Sie in diese Rolle wechseln? ... Du hast das Gespr√§ch mit der Bremse mitgeh√∂rt. Wie siehst du das, was sie sagt?'
        },
        {
          code: 'C5',
          name: 'Abr√ºstung einleiten',
          prompt: 'Stellen Sie sich vor, beide Anteile legen ihre Waffen nieder. Die Bremse muss nicht mehr so √ºbervorsichtig sein, der Unterst√ºtzer nicht mehr so dr√§ngend. Was w√ºrde dann m√∂glich?'
        },
        {
          code: 'C6',
          name: 'Neue Haltung entwickeln',
          prompt: 'Wie k√∂nnte eine Haltung aussehen, die das Beste von beiden vereint? Etwas wie: "Ich gehe [vorsichtig/mutig] vor und bleibe dabei [achtsam/pragmatisch]"?'
        }
      ],

      // 5. Klienten-Fragen (Solution Finder Fragen AN den Klienten)
      klientenFragen: [
        {
          code: 'F1',
          name: 'Zielformulierung',
          prompt: 'Beschreiben Sie mir bitte in 1-2 S√§tzen, was Sie erreichen m√∂chten. Schreiben Sie es so auf, als w√ºrden Sie es einem guten Freund erkl√§ren.'
        },
        {
          code: 'F2',
          name: 'Wichtigkeits-Skala',
          prompt: 'Auf einer Skala von 0 bis 10: Wie wichtig ist Ihnen dieses Ziel? 0 bedeutet "v√∂llig unwichtig", 10 bedeutet "absolut entscheidend f√ºr mein Leben".'
        },
        {
          code: 'F3',
          name: 'Schwierigkeits-Skala',
          prompt: 'Und wie schwierig sch√§tzen Sie es ein, dieses Ziel zu erreichen? 0 w√§re "kinderleicht", 10 w√§re "scheint unm√∂glich".'
        },
        {
          code: 'F4',
          name: 'Vertiefung Wichtigkeit/Schwierigkeit',
          prompt: 'Was genau macht es so wichtig/schwierig f√ºr Sie? Erz√§hlen Sie mir mehr davon.'
        },
        {
          code: 'F5',
          name: 'Unterst√ºtzer identifizieren',
          prompt: 'Welcher Anteil in Ihnen unterst√ºtzt dieses Ziel? Was sagt er? Auch f√ºr ihn w√§hlen Sie bitte eine Figur.'
        },
        {
          code: 'F6',
          name: 'Bremse benennen',
          prompt: 'Wenn Sie die Haltung der Bremse in 2-3 Worten beschreiben m√ºssten - wie w√ºrden Sie sie nennen? Etwas wie "√úbervorsichtige Sicherheitsw√§chterin" oder "Perfektionismus-fixierte Selbstblockade"?'
        },
        {
          code: 'F7',
          name: 'Positiver Kern der Bremse',
          prompt: 'Die Bremse ist nicht "b√∂se" oder "falsch". Sie √ºbertreibt nur, weil sie etwas Wichtiges sch√ºtzen will. Was k√∂nnte das sein? Was ist der gute Kern in ihrer Haltung?'
        },
        {
          code: 'F8',
          name: 'Ersten Schritt definieren',
          prompt: 'Was ist der allererste, kleinste Schritt, den Sie diese Woche machen k√∂nnen? Etwas, was Sie definitiv schaffen und was in Richtung Ihrer neuen Balance geht?'
        }
      ],

      // 6. Spannungsfeld-Fragen (40 Ruhestand-Spannungen)
      spannungsfeldFragen: [
        {
          code: 'SP1',
          name: 'Zeit: Gegenwart ‚Üî Zukunft',
          prompt: 'Wie erleben Sie aktuell den Umgang mit Ihrer Zeit - eher als Festhalten am Moment oder als st√§ndige Zukunftsplanung?'
        },
        {
          code: 'SP20',
          name: 'Vergangenheit ‚Üî Zukunftsangst',
          prompt: 'Merken Sie, dass Sie √∂fter in Erinnerungen schwelgen oder sich Sorgen um das machen, was kommen k√∂nnte?'
        },
        {
          code: 'SP21',
          name: 'Zeitsouver√§nit√§t ‚Üî Zeitlosigkeit',
          prompt: 'Erleben Sie Ihre neue Zeitfreiheit eher als Geschenk oder als Last?'
        },
        {
          code: 'SP23',
          name: 'Beruf: √úberidentifikation ‚Üî Verachtung',
          prompt: 'Wenn Sie an Ihre Arbeitszeit denken - √ºberwiegt Stolz, Verbitterung oder etwas anderes?'
        },
        {
          code: 'SP24',
          name: 'Status: Fixierung ‚Üî Bedeutungslosigkeit',
          prompt: 'Vermissen Sie Ihren fr√ºheren Status - die Anerkennung, die Wichtigkeit?'
        },
        {
          code: 'SP25',
          name: 'Leistung: Zwang ‚Üî Antriebslosigkeit',
          prompt: 'Haben Sie manchmal das Gef√ºhl, Sie m√ºssten auch im Ruhestand "produktiv" sein?'
        },
        {
          code: 'SP26',
          name: 'Rollen: Festhalten ‚Üî Beziehungsabbruch',
          prompt: 'In welchen Beziehungen erleben Sie Ver√§nderungsdruck - wo wird anders mit Ihnen umgegangen?'
        },
        {
          code: 'SP27',
          name: 'Sozial: Einsamkeit ‚Üî R√ºckzug',
          prompt: 'Schwanken Sie zwischen dem Bed√ºrfnis nach Gesellschaft und dem Wunsch nach Ruhe?'
        },
        {
          code: 'SP28',
          name: 'Familie: Gro√üeltern-√úberforderung ‚Üî Verweigerung',
          prompt: 'Wie erleben Sie die Erwartungen Ihrer Familie an Sie als Gro√ümutter/Gro√üvater?'
        },
        {
          code: 'SP29',
          name: 'Finanzen: Sparsamkeit ‚Üî Verschwendungsangst',
          prompt: 'Wie erleben Sie aktuell Entscheidungen rund ums Geld - eher als Knausern oder als Angst vor Ausgaben?'
        },
        {
          code: 'SP31',
          name: 'Wohnen: Ortsverbundenheit ‚Üî Rastlosigkeit',
          prompt: 'Erleben Sie Ihren aktuellen Wohnort als perfekt passend oder als einengend?'
        },
        {
          code: 'SP33',
          name: 'Sinn: Verm√§chtnis-Druck ‚Üî Resignation',
          prompt: 'Besch√§ftigt Sie die Frage, was von Ihrem Leben bleiben wird?'
        },
        {
          code: 'SP36',
          name: 'Gesundheit: Fixierung ‚Üî Vernachl√§ssigung',
          prompt: 'Wie viel Raum nehmen Gesundheitsthemen in Ihrem Leben ein?'
        },
        {
          code: 'SP37',
          name: 'Endlichkeit: Sterbeangst ‚Üî Lebensm√ºdigkeit',
          prompt: 'Wie pr√§sent ist das Thema Endlichkeit in Ihrem Leben?'
        },
        {
          code: 'SP38',
          name: 'Alter: Jugendlichkeit ‚Üî Vorzeitiges Altern',
          prompt: 'Wie stehen Sie zu den sichtbaren Zeichen des √Ñlterwerdens?'
        },
        {
          code: 'SP39',
          name: 'Lernen: Verweigerung ‚Üî Unstete Optimierung',
          prompt: 'Wie stehen Sie zu neuen Herausforderungen oder Lernm√∂glichkeiten?'
        },
        {
          code: 'SP40',
          name: 'Routine: Gefangenschaft ‚Üî Planlose Experimente',
          prompt: 'Wie erleben Sie Ihre t√§glichen Gewohnheiten - als Sicherheit oder als K√§fig?'
        }
      ]
    };

    // 12-Schritte Konfiguration
    const steps = [
      {
        id: 1,
        title: 'Einleitung & Problembeschreibung',
        phase: 'a',
        tasks: [
          'üéØ Coach und Klient sprechen zun√§chst pers√∂nlich',
          'üìã Coach zeigt Prompt-Repository als Landkarte',
          'ü§ù Gemeinsam ersten Prompt (T1) ausw√§hlen',
          '‚úçÔ∏è Klient schildert Anliegen, Coach protokolliert',
          'ü§ñ KI gibt ressourcenorientiertes, positives Feedback',
          '‚≠ê KI identifiziert erste F√§higkeiten und St√§rken',
          'üí¨ Beziehungsaufbau zur Maschine durch KI-Lob'
        ]
      },
      {
        id: 2,
        title: 'Ist-Soll-Analyse',
        phase: 'a',
        tasks: [
          'üìä Prompt T2 verwenden f√ºr strukturierte Analyse',
          'üîç √Ñu√üere Rahmenbedingungen erfassen',
          'üß† Psychische Prozesse dokumentieren',
          'üëÄ Beobachtbare Verhaltensweisen identifizieren',
          'üìà Faktische Folgen analysieren',
          'üìù Ist-Situation vollst√§ndig beschreiben',
          'üéØ Soll-Situation klar formulieren'
        ]
      },
      {
        id: 3,
        title: 'Bildarbeit & Visualisierung',
        phase: 'a',
        tasks: [
          'üñºÔ∏è Klient w√§hlt Bild f√ºr Coaching-Ziel',
          'üìù Bildbeschreibung in Ich-Form erstellen',
          'ü§ñ Prompt T3 f√ºr Bildanalyse verwenden',
          'üîó Beziehung zwischen Bild und Ziel kl√§ren',
          'üí° Bedeutung f√ºr Coachingproblematik erarbeiten',
          'üé® Visuelle Verankerung des Ziels',
          'üìã Erkenntnisse dokumentieren'
        ]
      },
      {
        id: 4,
        title: 'Diagnostik & Ausbalancierungsprobleme',
        phase: 'a',
        tasks: [
          'üîç Prompt T4 f√ºr Problemidentifikation nutzen',
          'üìö Textbaustein Ausbalancierungsprobleme verwenden',
          'üéØ Klarestes Ausbalancierungsproblem identifizieren',
          '‚ùì Kl√§rende Fragen entwickeln',
          'üß© Vorsichtige Diagnostik einleiten',
          'üìù Problematik pr√§ziser formulieren',
          '‚úÖ Diagnose validieren'
        ]
      },
      {
        id: 5,
        title: 'Schl√ºsselsituation & Schl√ºsselaffekt',
        phase: 'b',
        tasks: [
          'üîç Prompt T5 f√ºr Kernproblem-Identifikation',
          'üí≠ Schl√ºsselsituationen identifizieren',
          'üò¢ Schl√ºsselaffekt aufdecken',
          'üå™Ô∏è "Auge des Taifuns" finden',
          'üß† Unbewusste emotionale Kernproblematik',
          'üìù Affekt als Kernproblem verstehen',
          'üéØ Diagnostische Grundlage schaffen'
        ]
      },
      {
        id: 6,
        title: 'Tiefenpsychologisches Interview',
        phase: 'b',
        tasks: [
          'üéôÔ∏è Interview mit Klient durchf√ºhren',
          'üìù Vollst√§ndiges Transkript erstellen',
          'ü§ñ Transkript f√ºr KI-Analyse vorbereiten',
          'üí¨ Alle relevanten Aspekte erfassen',
          'üß† Tiefere Einsichten gewinnen',
          'üìã F√ºr n√§chsten Schritt dokumentieren'
        ]
      },
      {
        id: 7,
        title: 'KI-Auswertung & Ursachenanalyse',
        phase: 'b',
        tasks: [
          'üõë Prompt T7A: KI als Bremse versetzen',
          'üí≠ Weitere Gegenargumente sammeln',
          'üìä Prompt T7B: Ranking der 18 Dimensionen',
          'üîó Prompt T7C: Kausalzusammenh√§nge kl√§ren',
          'üß© Ursachenmodell entwickeln',
          'üìà Wichtigste Dimensionen priorisieren',
          'üéØ Klares Problemverst√§ndnis schaffen'
        ]
      },
      {
        id: 8,
        title: '√úbergeordnetes Entwicklungsziel',
        phase: 'c',
        tasks: [
          'üéØ Prompt T8 f√ºr Zielformulierung nutzen',
          'üîç "Ziel hinter dem Ziel" identifizieren',
          'üìà √úberdauernde Pers√∂nlichkeitsentwicklung',
          'üîó Verbindung zur Problemdiagnostik',
          'üå± Langfristige Entwicklung planen',
          'üí° Tiefere Erkenntnisse integrieren'
        ]
      },
      {
        id: 9,
        title: 'L√∂sungsstrategie entwickeln',
        phase: 'c',
        tasks: [
          'üõ†Ô∏è Praxisgerechte L√∂sung erarbeiten',
          'üéØ Strategie aus Diagnostik ableiten',
          'üìã Konkrete Schritte definieren',
          'üîÑ Umsetzbarkeit pr√ºfen',
          'üí™ Ressourcen identifizieren',
          'üìù Strategie dokumentieren'
        ]
      },
      {
        id: 10,
        title: 'Widerstandsanalyse',
        phase: 'c',
        tasks: [
          'ü§ñ Prompt T10 f√ºr Widerstandsanalyse',
          'üß† Realit√§tspr√§gende √úberzeugungen identifizieren',
          'üìã Innere Regeln rekonstruieren',
          'üò® Sorgen und √Ñngste aufdecken',
          'üöß Umsetzungshindernisse verstehen',
          'üí≠ Denkweisen analysieren',
          'üîì √úberwindungsstrategien entwickeln'
        ]
      },
      {
        id: 11,
        title: 'Erfolgsimagination',
        phase: 'c',
        tasks: [
          'üé¨ Prompt T11 f√ºr Erlebenserz√§hlung nutzen',
          'üìö Textbaustein Ausbalancierungsprobleme verwenden',
          '‚öñÔ∏è Komplement√§rkr√§fte integrieren',
          'üéØ Optimale Ausbalancierung beschreiben',
          'üé≠ Pers√∂nliche Ich-Form-Erz√§hlung',
          'üé• Filmische, konkrete Vorstellung',
          'üîÑ Umkonditionierung erm√∂glichen'
        ]
      },
      {
        id: 12,
        title: 'Integration & Abschluss',
        phase: 'c',
        tasks: [
          'üîÑ Alle Erkenntnisse zusammenf√ºhren',
          'üìã Vollst√§ndige Dokumentation',
          'üéØ N√§chste Schritte definieren',
          'üìÖ Follow-up planen',
          'üí™ Motivation st√§rken',
          'üéâ Erfolg w√ºrdigen'
        ]
      }
    ];

    // Globale Variablen
    let currentStep = 1;
    let taskStatus = {};
    let chatHistory = [];

    // Initialisierung
    function init() {
      loadStep(currentStep);
      updateProgressBar();
      updateDateTime();
      
      // Task Status initialisieren
      steps.forEach(step => {
        taskStatus[step.id] = step.tasks.map(() => false);
      });
    }

    // Schritt laden
    function loadStep(stepNumber) {
      currentStep = stepNumber;
      const step = steps.find(s => s.id === stepNumber);
      if (!step) return;

      const stepContent = document.getElementById('stepContent');
      stepContent.innerHTML = `
        <h3>Schritt ${step.id}: ${step.title}</h3>
        <div class="progress-indicator">
          <div class="progress-bar-fill" style="width: ${getStepProgress(step.id)}%"></div>
          <div>${getCompletedTasks(step.id)} von ${step.tasks.length} Aufgaben erledigt</div>
        </div>
        <ul class="task-list">
          ${step.tasks.map((task, index) => `
            <li class="task-item ${taskStatus[step.id] && taskStatus[step.id][index] ? 'completed' : ''}">
              <div class="task-checkbox ${taskStatus[step.id] && taskStatus[step.id][index] ? 'checked' : ''}" 
                   onclick="toggleTask(${step.id}, ${index})">
                ${taskStatus[step.id] && taskStatus[step.id][index] ? '‚úì' : ''}
              </div>
              <div class="task-text ${taskStatus[step.id] && taskStatus[step.id][index] ? 'completed' : ''}">
                ${task}
              </div>
            </li>
          `).join('')}
        </ul>
        <div class="navigation-buttons">
          <button class="nav-button prev" onclick="previousStep()" ${stepNumber === 1 ? 'disabled' : ''}>
            ‚Üê Zur√ºck
          </button>
          <button class="nav-button next ${isStepCompleted(step.id) ? 'completed' : ''}" 
                  onclick="nextStep()" ${stepNumber === steps.length ? 'disabled' : ''}>
            ${stepNumber === steps.length ? 'Fertig!' : 'Weiter ‚Üí'}
          </button>
        </div>
      `;

      updateAssistantSuggestions(step);
    }

    // Progress Bar aktualisieren
    function updateProgressBar() {
      const progressBar = document.getElementById('progressBar');
      progressBar.innerHTML = steps.map(step => `
        <div class="progress-step ${getStepStatus(step.id)}" onclick="loadStep(${step.id})">
          <div class="step-number">${step.id}</div>
          <div class="step-title">${step.title}</div>
        </div>
      `).join('');
    }

    // Schritt-Status ermitteln
    function getStepStatus(stepId) {
      if (stepId < currentStep) return 'completed';
      if (stepId === currentStep) return 'active';
      return 'pending';
    }

    // Task Status umschalten
    function toggleTask(stepId, taskIndex) {
      if (!taskStatus[stepId]) {
        taskStatus[stepId] = steps.find(s => s.id === stepId).tasks.map(() => false);
      }
      taskStatus[stepId][taskIndex] = !taskStatus[stepId][taskIndex];
      loadStep(currentStep);
      updateProgressBar();
    }

    // Schritt-Fortschritt berechnen
    function getStepProgress(stepId) {
      if (!taskStatus[stepId]) return 0;
      const completed = taskStatus[stepId].filter(status => status).length;
      const total = taskStatus[stepId].length;
      return Math.round((completed / total) * 100);
    }

    // Erledigte Aufgaben z√§hlen
    function getCompletedTasks(stepId) {
      if (!taskStatus[stepId]) return 0;
      return taskStatus[stepId].filter(status => status).length;
    }

    // Schritt als erledigt pr√ºfen
    function isStepCompleted(stepId) {
      return getStepProgress(stepId) === 100;
    }

    // Navigation
    function nextStep() {
      if (currentStep < steps.length) {
        loadStep(currentStep + 1);
        updateProgressBar();
      }
    }

    function previousStep() {
      if (currentStep > 1) {
        loadStep(currentStep - 1);
        updateProgressBar();
      }
    }

    // KI-Assistent Vorschl√§ge
    function updateAssistantSuggestions(step) {
      const suggestions = document.getElementById('currentStepSuggestions');
      const stepSuggestions = {
        1: ['Verwende T1 f√ºr Problembeschreibung', 'Wie gebe ich positives Feedback?', 'Beziehungsaufbau zur KI'],
        2: ['T2 f√ºr Ist-Soll-Analyse nutzen', 'Strukturierte Problemerfassung', 'Rahmenbedingungen dokumentieren'],
        3: ['T3 f√ºr Bildanalyse verwenden', 'Visualisierung des Ziels', 'Bildbeschreibung anleiten'],
        4: ['T4 f√ºr Ausbalancierungsprobleme', 'Diagnostik einleiten', 'Textbausteine nutzen'],
        5: ['T5 f√ºr Schl√ºsselaffekt finden', 'Auge des Taifuns identifizieren', 'Emotionale Kernproblematik'],
        6: ['Tiefenpsychologisches Interview', 'Vollst√§ndiges Transkript', 'Alle Aspekte erfassen'],
        7: ['T7A: KI als Bremse', 'T7B: Dimensionen-Ranking', 'T7C: Kausalzusammenh√§nge'],
        8: ['T8: √úbergeordnetes Ziel', 'Ziel hinter dem Ziel', 'Pers√∂nlichkeitsentwicklung'],
        9: ['Praxisgerechte L√∂sung', 'Aus Diagnostik ableiten', 'Umsetzbarkeit pr√ºfen'],
        10: ['T10: Widerstandsanalyse', 'Innere Regeln finden', '√úberzeugungen identifizieren'],
        11: ['T11: Erfolgsimagination', 'Erlebenserz√§hlung erstellen', 'Komplement√§rkr√§fte nutzen'],
        12: ['Integration aller Erkenntnisse', 'Vollst√§ndige Dokumentation', 'Follow-up planen']
      };

      suggestions.innerHTML = `
        <p><strong>Triadische Prompts f√ºr Schritt ${step.id}:</strong></p>
        ${stepSuggestions[step.id].map(suggestion => `
          <div class="suggestion" onclick="selectSuggestion('${suggestion}')">${suggestion}</div>
        `).join('')}
      `;
    }

    // Suggestion ausw√§hlen
    function selectSuggestion(suggestion) {
      document.getElementById('assistantInput').value = suggestion;
      event.target.classList.add('clicked');
      setTimeout(() => event.target.classList.remove('clicked'), 1000);
    }

    // Chat-Funktionen
    function sendCoachingMessage() {
      const input = document.getElementById('coachingInput');
      const message = input.value.trim();
      
      if (message) {
        addChatMessage('Coach', message);
        input.value = '';
        
        // API-Call zur echten KI
        callOpenAI(message, currentStep, 'coaching_dialog');
      }
    }

    function sendAssistantMessage() {
      const input = document.getElementById('assistantInput');
      const message = input.value.trim();
      
      if (message) {
        addChatMessage('Coach', message);
        input.value = '';
        
        // API-Call zur echten KI
        callOpenAI(message, currentStep, 'ki_assistant');
      }
    }

    function addChatMessage(sender, message) {
      const chatMessages = document.getElementById('chatMessages');
      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${sender.toLowerCase()}`;
      messageDiv.innerHTML = `
        <div class="message-sender">${sender}</div>
        <div>${message}</div>
      `;
      chatMessages.appendChild(messageDiv);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    // OpenAI API Call
    async function callOpenAI(message, step, source) {
      try {
        const response = await fetch('/api/openai-chat', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            messages: [
              {
                role: 'system',
                content: generateSystemPrompt(step, source)
              },
              {
                role: 'user',
                content: message
              }
            ],
            source: source,
            step: step
          })
        });

        const data = await response.json();
        const aiResponse = data.choices[0].message.content;
        
        // KI-Antwort anzeigen
        addChatMessage('KI', aiResponse);
        
      } catch (error) {
        console.error('OpenAI API Error:', error);
        addChatMessage('KI', 'Entschuldigung, es gab einen Fehler bei der KI-Anfrage.');
      }
    }

    // System-Prompt generieren
    function generateSystemPrompt(step, source) {
      const basePrompt = `Du bist ein KI-Assistent im triadischen Coaching-System. 
      Du erh√§ltst Nachrichten aus zwei verschiedenen Bereichen:
      
      **source: "ki_assistant"** ‚Üí Coach-Unterst√ºtzung
      - Fachliche Beratung und Methodenerkl√§rung
      - Konkrete Handlungsempfehlungen f√ºr triadisches Coaching
      - Prompt-Vorschl√§ge und Anwendungshilfen
      
      **source: "coaching_dialog"** ‚Üí Coachee-Dialog
      - Empathische, direkte Kommunikation
      - Ressourcenorientiertes, positives Feedback
      - L√∂sungsorientierte Fragen und Unterst√ºtzung
      
      **Aktueller Schritt: ${step}/12**
      **Nachrichten-Quelle: ${source}**
      
      **Triadisches Coaching Expertise:** Du kennst die 12 Schritte des triadischen KI-Coachings, 
      Ausbalancierungsprobleme, Schl√ºsselaffekte, Komplement√§rkr√§fte und Erfolgsimagination.
      
      **WICHTIG:** Nutze dein Fachwissen aus dem triadischen System und den Textbausteinen 
      zu Ausbalancierungsproblemen aktiv.`;
      
      return basePrompt;
    }

    // Repository-Funktionen
    function openRepository() {
      document.getElementById('repositoryModal').style.display = 'flex';
      loadRepositoryPrompts();
      setTimeout(() => {
        setupRepositorySearch();
      }, 100);
    }

    function closeRepository() {
      document.getElementById('repositoryModal').style.display = 'none';
    }

    function loadRepositoryPrompts() {
      Object.keys(repositoryPrompts).forEach(category => {
        const container = document.getElementById(`${category}-repo-prompts`);
        if (container) {
          container.innerHTML = repositoryPrompts[category].map(prompt => `
            <div class="repo-prompt-card" onclick="copyRepositoryPrompt('${prompt.code}', '${prompt.prompt.replace(/'/g, "\\'")}')">
              <div class="repo-prompt-name">
                <span class="repo-prompt-code">${prompt.code}</span>
                ${prompt.name}
              </div>
              <div class="repo-prompt-text">${prompt.prompt}</div>
            </div>
          `).join('');
        }
      });
    }

    function copyRepositoryPrompt(code, text) {
      navigator.clipboard.writeText(text).then(() => {
        // Visuelles Feedback
        const cards = document.querySelectorAll('.repo-prompt-card');
        cards.forEach(card => {
          if (card.innerHTML.includes(code)) {
            card.classList.add('copied');
            setTimeout(() => card.classList.remove('copied'), 1000);
          }
        });
        
        // Prompt auch in Chat-Input einf√ºgen
        const chatInput = document.getElementById('coachingInput');
        if (chatInput) {
          chatInput.value = text;
          chatInput.focus();
        }
      }).catch(err => {
        console.error('Fehler beim Kopieren:', err);
        alert('Fehler beim Kopieren des Prompts');
      });
    }

    // Repository-Suchfunktion
    function setupRepositorySearch() {
      const searchInput = document.getElementById('repoSearchInput');
      if (searchInput) {
        searchInput.addEventListener('input', (e) => {
          const searchTerm = e.target.value.toLowerCase();
          
          Object.keys(repositoryPrompts).forEach(category => {
            const container = document.getElementById(`${category}-repo-prompts`);
            const cards = container.querySelectorAll('.repo-prompt-card');
            
            cards.forEach(card => {
              const cardText = card.textContent.toLowerCase();
              if (cardText.includes(searchTerm) || searchTerm === '') {
                card.style.display = 'block';
              } else {
                card.style.display = 'none';
              }
            });
          });
        });
      }
    }

    // Modal bei Klick au√üerhalb schlie√üen
    window.onclick = function(event) {
      const modal = document.getElementById('repositoryModal');
      if (event.target === modal) {
        closeRepository();
      }
    }

    // Datum/Zeit aktualisieren
    function updateDateTime() {
      const now = new Date();
      const formatted = now.toLocaleString('de-DE', {
        day: '2-digit',
        month: '2-digit',
        year: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      });
      document.getElementById('currentDateTime').textContent = formatted;
    }

    // Initialisierung beim Laden
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>